1                         J E S 2  J O B  L O G  --  S Y S T E M  M V S 1  --  N O D E  N 1
0
 11.31.09 JOB06792 ---- FRIDAY,    02 FEB 2024 ----
 11.31.09 JOB06792  IRR010I  USERID TRAIN05  IS ASSIGNED TO THIS JOB.
 11.31.09 JOB06792  ICH70001I TRAIN05  LAST ACCESS AT 10:50:18 ON FRIDAY, FEBRUARY 2, 2024
 11.31.09 JOB06792  $HASP373 TRAIN05I STARTED - INIT 1    - CLASS A        - SYS MVS1
 11.31.09 JOB06792  IEF403I TRAIN05I - STARTED - TIME=11.31.09
 11.31.09 JOB06792  -                                      ----TIMINGS (MINUTES)-----                          -----PAGING COUNTS----
 11.31.09 JOB06792  -STEPNAME PROCSTEP    RC   EXCP   CONN       TCB       SRB  CLOCK          SERV  WORKLOAD  PAGE  SWAP   VIO SWAPS
 11.31.09 JOB06792  -PTPCH                00    239     13  0.000863  0.000035    0.0           351  PRDBAT       0     0     0     0
 11.31.09 JOB06792  IEF404I TRAIN05I - ENDED - TIME=11.31.09
 11.31.09 JOB06792  -TRAIN05I ENDED.  NAME-MAINTEC              TOTAL TCB CPU TIME= 0.000863 TOTAL ELAPSED TIME=   0.0 SUBSYS=JES2
 11.31.09 JOB06792  $HASP395 TRAIN05I ENDED - RC=0000
0------ JES2 JOB STATISTICS ------
-  02 FEB 2024 JOB EXECUTION DATE
-           17 CARDS READ
-        1,339 SYSOUT PRINT RECORDS
-            0 SYSOUT PUNCH RECORDS
-          112 SYSOUT SPOOL KBYTES
-         0.00 MINUTES EXECUTION TIME
         1 //TRAIN05I JOB 43312,'MAINTEC',                                         JOB06792
           //             CLASS=A,MSGCLASS=H,MSGLEVEL=(1,1),NOTIFY=&SYSUID         00020000
           //*******************************************************               00030000
           //*** I-P-O  I(NPUT)   P(ROCESS)   O(UTPUT)  ************               00040000
           //*** I - LIBRARY                          **************               00050000
           //*** P - PRINT ENTIRE LIBRARY FROM SYSUT1  TO  SYSUT2  *               00060000
           //***     PO=LIBRARY (MAX)MEMBS 200 1 RECORD FIELDS STMT*               00070000
           //*** O - SEND DATA TO "PRINT" / JES / ******************               00080000
           //*******************************************************               00090000
           IEFC653I SUBSTITUTION JCL - 43312,'MAINTEC',CLASS=A,MSGCLASS=H,MSGLEVEL=(1,1),NOTIFY=TRAIN05
         2 //PTPCH EXEC  PGM=IEBPTPCH                                              00100000
         3 //SYSPRINT DD  SYSOUT=*                                                 00110000
         4 //SYSIN    DD  *                                                        00120000
         5 //SYSUT2   DD  SYSOUT=*                                         OUTPUT  00150000
           //******  PRINT UP TO 200 MEMBERS OF A PDS                              00160000
         6 //SYSUT1  DD  DSN=TRAIN05.CLASS.SIUA.CAPSTONE,DISP=SHR          INPUT   00170002
 ICH70001I TRAIN05  LAST ACCESS AT 10:50:18 ON FRIDAY, FEBRUARY 2, 2024
 IEFA111I TRAIN05I IS USING THE FOLLOWING JOB RELATED SETTINGS:
          SWA=BELOW,TIOT SIZE=32K,DSENQSHR=DISALLOW,GDGBIAS=JOB
 IEF236I ALLOC. FOR TRAIN05I PTPCH
 IEF237I JES2 ALLOCATED TO SYSPRINT
 IEF237I JES2 ALLOCATED TO SYSIN
 IEF237I JES2 ALLOCATED TO SYSUT2
 IEF237I 306C ALLOCATED TO SYSUT1
 IEF142I TRAIN05I PTPCH - STEP WAS EXECUTED - COND CODE 0000
 IEF285I   TRAIN05.TRAIN05I.JOB06792.D0000102.?         SYSOUT
 IEF285I   TRAIN05.TRAIN05I.JOB06792.D0000101.?         SYSIN
 IEF285I   TRAIN05.TRAIN05I.JOB06792.D0000103.?         SYSOUT
 IEF285I   TRAIN05.CLASS.SIUA.CAPSTONE                  KEPT
 IEF285I   VOL SER NOS= USER10.
 IEF373I STEP/PTPCH   /START 2024033.1131
 IEF032I STEP/PTPCH   /STOP  2024033.1131
         CPU:     0 HR  00 MIN  00.05 SEC    SRB:     0 HR  00 MIN  00.00 SEC
         VIRT:    64K  SYS:   252K  EXT:        0K  SYS:    12784K
         ATB- REAL:                  1056K  SLOTS:                     0K
              VIRT- ALLOC:      13M SHRD:       0M
 IEF375I  JOB/TRAIN05I/START 2024033.1131
 IEF033I  JOB/TRAIN05I/STOP  2024033.1131
         CPU:     0 HR  00 MIN  00.05 SEC    SRB:     0 HR  00 MIN  00.00 SEC
1
-PRINT/PUNCH DATA SET UTILITY                                                                      PAGE 0001
   PRINT TYPORG=PO,MAXNAME=200,MAXFLDS=1                                 00130000
   RECORD FIELD=(80)                                                     00140000
  EOF ON SYSIN
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
1                                                                                                              PAGE 0001
 MEMBER NAME  MERCHANT
 CREATE TABLE MERCHANT                                                   00010001
   ( ID                 DECIMAL(13)     NOT NULL                         00020005
    , SEQ               DECIMAL(02)     NOT NULL                         00030003
    , ADDRESS           CHAR(24)        NOT NULL                         00040003
    , CITY              CHAR(21)        NOT NULL                         00050003
    , STATE             CHAR(02)        NOT NULL                         00060003
    , MSG               CHAR(05)        NOT NULL                         00070003
   )                                                                     00080001
 ;                                                                       00090001
 CREATE UNIQUE INDEX XMERCHANT1 ON MERCHANT(ID,SEQ)                      00100001
 ;                                                                       00110001
 INSERT INTO MERCHANT                                                    00120001
    (ID, SEQ, ADDRESS, CITY, STATE, MSG)                                 00130001
 VALUES (20056040000, 00, '1261 NO AZUSA AVE', 'COVINA', 'CA', 'NOTES' ) 00140005
 ;                                                                       00150005
 SELECT *                                                                00160005
 FROM MERCHANT                                                           00170006
 ;                                                                       00180005
1                                                                                                              PAGE 0002
 MEMBER NAME  MPRINT
 //TRAIN05V   JOB (123),'REGGIE CALHOUN',                                00010010
 //         MSGCLASS=X,CLASS=A,NOTIFY=&SYSUID,TIME=(0,3)                 00020007
 //********************************************************************  00030000
 //*** I-P-O  I(INPUT)   P(PROCESS)   O(OUTPUT)  **********************  00040000
 //*** I - DD * TO LIST RECORDS                                ********  00050000
 //*** P - PGM=IDCAMS REPRO TO COPY                            ********  00060010
 //*** O - DSN= PRINT CONTENTS INTO &&TEMP DATASET             ********  00070010
 //********************************************************************  00080000
 //STEP2 EXEC PGM=IDCAMS                                                 00090011
 //IDIN  DD   DSN=TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH,DISP=SHR        00100012
 //SYSPRINT DD SYSOUT=*,OUTLIM=1000                                      00120000
 //SYSIN DD *                                                            00130000
      PRINT   INFILE(IDIN) CHAR           -                              00160013
      FROMKEY('0020056040000') TOKEY('0020058040000')                    00161012
 /*                                                                      00170000
1                                                                                                              PAGE 0003
 MEMBER NAME  TESTD
 DELETE FROM MERCHANT                                                    00010000
 WHERE ID = 20056040000.                                                 00020000
1                                                                                                              PAGE 0004
 MEMBER NAME  TESTM
 SELECT *                                                                00010005
 FROM MERCHANT                                                           00020005
1                                                                                                              PAGE 0005
 MEMBER NAME  TRAIN05
        IDENTIFICATION DIVISION.                                         00010000
       *-----------------------                                          00020000
        PROGRAM-ID.    DB2SKEL.                                          00030000
                                                                         00040000
        ENVIRONMENT DIVISION.                                            00050000
       *--------------------                                             00060000
        CONFIGURATION SECTION.                                           00070000
        INPUT-OUTPUT SECTION.                                            00080000
        FILE-CONTROL.                                                    00090000
            SELECT CARDIN           ASSIGN TO CARDIN.                    00100000
                                                                         00110000
        DATA DIVISION.                                                   00120000
       *-------------                                                    00130000
        FILE SECTION.                                                    00140000
        FD      CARDIN                                                   00150000
                RECORD CONTAINS 80 CHARACTERS                            00160000
                RECORDING MODE IS F                                      00170000
                BLOCK CONTAINS 0 RECORDS.                                00180000
        01  CARDREC                 PIC X(80).                           00190000
                                                                         00200000
        WORKING-STORAGE SECTION.                                         00210000
        01  OUTPUT-BUFFER.                                               00220000
            05  OUTPUT-BUFFER-REC          PIC X(132).                   00230000
        01  IN-BUFFER.                                                   00240000
            05  TRAN-CODE                  PIC X(01).                    00250000
            05  TRAN-EMPLOYEE-NUMBER       PIC X(06).                    00260000
            05  TRAN-DEPARTMENT-NUMBER     PIC X(03).                    00270000
              05  TRAN-COL-NAME REDEFINES                                00280000
                   TRAN-DEPARTMENT-NUMBER  PIC X(03).                    00290000
            05  TRAN-LAST-NAME             PIC X(15).                    00300000
            05  TRAN-FIRST-NAME            PIC X(12).                    00310000
            05  TRAN-MIDDLE-INITIAL        PIC X(01).                    00320000
            05  TRAN-HIRE-DATE             PIC X(10).                    00330000
            05  TRAN-BIRTH-DATE            PIC X(10).                    00340000
            05  TRAN-PHONE-NUMBER          PIC X(04).                    00350000
            05  TRAN-SALARY                PIC 9(6)V99.                  00360000
            05  FILLER                     PIC X(10).                    00370000
                                                                         00380000
       *****************************************************             00390000
       * VARIABLES FOR ERROR-HANDLING                      *             00400000
       *****************************************************             00410000
        01  INPUT-SWITCH              PIC X(01)    VALUE 'Y'.            00420000
                88  NO-MORE-INPUT     VALUE 'N'.                         00430000
                88  MORE-INPUT        VALUE 'Y'.                         00440000
                                                                         00450000
        01  DB2-ERROR-SWITCH          PIC X(01)    VALUE 'N'.            00460000
                88  DB2-ERROR         VALUE 'Y'.                         00470000
                                                                         00480000
        01  ERROR-MESSAGE.                                               00490000
                05  ERROR-LEN   PIC S9(4)  COMP VALUE 1320.              00500000
                05  ERROR-TEXT  PIC X(132) OCCURS 10 TIMES               00510000
                                           INDEXED BY ERROR-INDEX.       00520000
        01  ERROR-TEXT-LEN      PIC S9(9)  COMP VALUE +132.              00530000
       *                                                                 00540000
        01  WS-DATE             PIC X(10).                               00550000
        01  WS-SQLCODE          PIC 99999-.                              00560000
       *                                                                 00570000
       **???????????????????????????????????????????????????             00580000
1                                                                                                              PAGE 0006
 MEMBER NAME  TRAIN05
       * PROVIDE THE SQL COMMUNICATION AREA                *             00590000
       **???????????????????????????????????????????????????             00600000
               EXEC  SQL  INCLUDE  SQLCA  END-EXEC.                      00610000
       **???????????????????????????????????????????????????             00620000
       * COPY A TABLE DECLARATION AND COBOL STRUCTURE      *             00630000
       * FOR YOUR TABLE                                    *             00640000
       * YOU SHOULD HAVE ALREADY PREPARED THIS USING       *             00650000
       * THE DCLGEN FUNCTION.                              *             00660000
       **???????????????????????????????????????????????????             00670000
       *                                                                 00680000
        PROCEDURE DIVISION.                                              00690000
       *------------------                                               00700000
            DISPLAY 'BEFORE 0000-MAIN-LINE'                              00710000
            DISPLAY ' '                                                  00720000
            DISPLAY '**********************************'                 00730000
            DISPLAY '*****  START OF INSTUCTOR TEST ***'                 00740000
            DISPLAY '**********************************'                 00750000
                                                                         00760000
       *********  TO MAKE SURE THAT WE CAN ACCESS DB2 *****************  00770000
            EXEC SQL                                                     00780000
               SET :WS-DATE = CURRENT DATE                               00790000
            END-EXEC                                                     00800000
            DISPLAY 'WS-DATE=' WS-DATE                                   00810000
                                                                         00820000
       *********  MAKE SURE THAT THE DSNTIAR ROUTINE WORKS CORRECTLY **  00830000
            MOVE +100 TO SQLCODE                                         00840000
            PERFORM Z000-DB2-ERROR                                       00850000
            DISPLAY ' '                                                  00860000
            DISPLAY '**********************************'                 00870000
            DISPLAY '***** E-N-D  OF INSTUCTOR TEST ***'                 00880000
            DISPLAY '**********************************'                 00890000
                                                                    .    00900000
                                                                         00910000
        0000-MAINLINE.                                                   00920000
            OPEN INPUT      CARDIN                                       00930000
                                                                         00940000
            PERFORM 1000-PROCESS-INPUT                                   00950000
               UNTIL INPUT-SWITCH = 'N'                                  00960000
                                                                         00970000
            CLOSE CARDIN                                                 00980000
                                                                         00990000
            GOBACK                                                       01000000
            .                                                            01010000
                                                                         01020000
        1000-PROCESS-INPUT.                                              01030000
            READ CARDIN RECORD INTO IN-BUFFER                            01040000
                AT END MOVE 'N' TO INPUT-SWITCH                          01050000
                NOT AT END CONTINUE                                      01060000
            END-READ                                                     01070000
                                                                         01080000
            DISPLAY ' '                                                  01090000
            DISPLAY '*************************************'              01100000
            DISPLAY '*   IN-BUFFER=', IN-BUFFER                          01110000
            DISPLAY '*************************************'              01120000
                                                                         01130000
            IF MORE-INPUT                                                01140000
                 EVALUATE TRAN-CODE                                      01150000
                     WHEN 'L' PERFORM 1000-TRAN-L                        01160000
1                                                                                                              PAGE 0007
 MEMBER NAME  TRAIN05
                     WHEN 'A' PERFORM 2000-TRAN-A                        01170000
                     WHEN 'E' PERFORM 3000-TRAN-E                        01180000
                     WHEN 'I' PERFORM 4000-TRAN-I                        01190000
                     WHEN 'D' PERFORM 5000-TRAN-D                        01200000
                     WHEN 'U' PERFORM 6000-TRAN-U                        01210000
                     WHEN 'Z' PERFORM 7000-TRAN-Z                        01220000
                     WHEN 'Y' PERFORM 8000-TRAN-Y                        01230000
                     WHEN 'X' PERFORM 9000-TRAN-X                        01240000
                     WHEN 'W' PERFORM A000-TRAN-W                        01250000
                     WHEN 'T' PERFORM B000-TRAN-T                        01260000
                     WHEN OTHER PERFORM  N000-OTHER-TRAN                 01270000
            END-EVALUATE                                                 01280000
            .                                                            01290000
                                                                         01300000
        1000-TRAN-L.                                                     01310000
            DISPLAY '   '                                                01320000
            DISPLAY '    --------------------------------'               01330000
            DISPLAY '    ---- PROCESS TRAN CODE L -------'               01340000
            DISPLAY '    --------------------------------'               01350000
                                                                         01360000
       ***************  PLACE YOUR SQL STATEMENT HERE  **************    01370000
                                                                         01380000
            DISPLAY 'SQLCODE='       SQLCODE                             01390000
            MOVE    SQLCODE       TO WS-SQLCODE                          01400000
            DISPLAY 'WS-SQLCODE='    WS-SQLCODE                          01410000
            DISPLAY 'SQLWARN0='      SQLWARN0                            01420000
                                                                         01430000
            EVALUATE SQLCODE                                             01440000
               WHEN 0  DISPLAY 'EMPLOYEE ' TRAN-EMPLOYEE-NUMBER ' FOUND' 01450000
               WHEN 100  DISPLAY 'EMPLOYEE NOT FOUND FOR '               01460000
                                  TRAN-EMPLOYEE-NUMBER                   01470000
               WHEN OTHER  PERFORM Z000-DB2-ERROR                        01480000
            END-EVALUATE                                                 01490000
            .                                                            01500000
                                                                         01510000
        2000-TRAN-A.                                                     01520000
            DISPLAY '   '                                                01530000
            DISPLAY '-------------------------------------'              01540000
            DISPLAY '2000 TRAN CODE A....'                               01550000
            .                                                            01560000
                                                                         01570000
        3000-TRAN-E.                                                     01580000
            DISPLAY '   '                                                01590000
            DISPLAY '-------------------------------------'              01600000
            DISPLAY '3000 TRAN CODE E....'                               01610000
            .                                                            01620000
                                                                         01630000
                                                                         01640000
        4000-TRAN-I.                                                     01650000
            DISPLAY '   '                                                01660000
            DISPLAY '-------------------------------------'              01670000
            DISPLAY '4000 TRAN CODE I....'                               01680000
            .                                                            01690000
                                                                         01700000
        5000-TRAN-D.                                                     01710000
            DISPLAY '   '                                                01720000
            DISPLAY '-------------------------------------'              01730000
            DISPLAY '5000 TRAN CODE D....'                               01740000
1                                                                                                              PAGE 0008
 MEMBER NAME  TRAIN05
            .                                                            01750000
                                                                         01760000
        6000-TRAN-U.                                                     01770000
            DISPLAY '   '                                                01780000
            DISPLAY '-------------------------------------'              01790000
            DISPLAY '6000 TRAN CODE U....'                               01800000
            .                                                            01810000
                                                                         01820000
        7000-TRAN-Z.                                                     01830000
            DISPLAY '   '                                                01840000
            DISPLAY '-------------------------------------'              01850000
            DISPLAY '7000 TRAN CODE Z....'                               01860000
            .                                                            01870000
                                                                         01880000
        8000-TRAN-Y.                                                     01890000
            DISPLAY '   '                                                01900000
            DISPLAY '-------------------------------------'              01910000
            DISPLAY '8000 TRAN CODE Y....'                               01920000
            .                                                            01930000
                                                                         01940000
        9000-TRAN-X.                                                     01950000
            DISPLAY '   '                                                01960000
            DISPLAY '-------------------------------------'              01970000
            DISPLAY '9000 TRAN CODE X....'                               01980000
            .                                                            01990000
                                                                         02000000
        A000-TRAN-W.                                                     02010000
            DISPLAY '   '                                                02020000
            DISPLAY '-------------------------------------'              02030000
            DISPLAY 'A000 TRAN CODE W....'                               02040000
            .                                                            02050000
                                                                         02060000
        B000-TRAN-T.                                                     02070000
            DISPLAY '   '                                                02080000
            DISPLAY '-------------------------------------'              02090000
            DISPLAY 'B000 TRAN CODE T....'                               02100000
            .                                                            02110000
                                                                         02120000
        N000-OTHER-TRAN.                                                 02130000
            DISPLAY 'N000 OTHER TRAN ....'                               02140000
            .                                                            02150000
                                                                         02160000
        Z000-DB2-ERROR.                                                  02170000
            DISPLAY 'Z000-DB2-ERROR....'                                 02180000
            CALL 'DSNTIAR' USING SQLCA ERROR-MESSAGE ERROR-TEXT-LEN      02190000
            PERFORM Z001-ERROR-PRINT                                     02200000
                VARYING ERROR-INDEX  FROM 1 BY 1                         02210000
                      UNTIL ERROR-INDEX GREATER THAN 10                  02220000
            .                                                            02230000
                                                                         02240000
        Z001-ERROR-PRINT.                                                02250000
            MOVE ERROR-TEXT(ERROR-INDEX) TO OUTPUT-BUFFER                02260000
            DISPLAY OUTPUT-BUFFER                                        02270000
            .                                                            02280000
                                                                         02290000
1                                                                                                              PAGE 0009
 MEMBER NAME  DB2DBIN2
 //TRAIN05B JOB ,,NOTIFY=&SYSUID,CLASS=A,MSGLEVEL=(1,1),MSGCLASS=H       00010002
 //JOBLIB   DD  DISP=SHR,DSN=DSNA10.SDSNEXIT                             00011001
 //         DD  DISP=SHR,DSN=DSNA10.SDSNLOAD                             00012001
 //BIND     EXEC PGM=IKJEFT01,DYNAMNBR=20                                00060000
 //DBRMLIB  DD DISP=SHR,                                                 00070000
 //         DSN='TRAIN05.CLASS.DB2.DBRMLIB'             --> DBRM LIBRARY 00080002
 //SYSTSPRT DD SYSOUT=*                                                  00090000
 //SYSPRINT DD SYSOUT=*                                                  00100000
 //SYSUMUMP DD SYSOUT=*                                                  00110000
 //SYSOUT   DD SYSOUT=*                                                  00120000
 //REPORT   DD SYSOUT=*                                                  00130000
 //SYSTSIN  DD *                                                         00140000
   DSN SYSTEM(DSN1)                                                      00150000
   BIND PLAN(TRAIN05) MEMBER(TRAIN05) ISOLATION(RR) ACTION(REP)          00160003
 //*                                                                     00170000
1                                                                                                              PAGE 0010
 MEMBER NAME  DB2COB2
 //TRAIN00C JOB ,,CLASS=A,NOTIFY=&SYSUID                                 00001006
 //***IN00D JOB ,,NOTIFY=&SYSUID,CLASS=A,MSGCLASS=H                      00010001
 //         JCLLIB ORDER=IBMUSER.COMPILER.JCLS                           00020001
 //EXEC1    EXEC DB2JCL,                                                 00022001
 //         SRCLIB='TRAIN00.CLASS.DB2',          -->  SOURCE LIB         00023004
 //         DBRMLIB='TRAIN05.CLASS.DB2.DBRMLIB', -->DBRM LIBRARY         00024007
 //         MEM=TRAIN00,                         -->  MEMBER NAME        00025005
 //         DCLLIB='TRAIN05.CLASS.DB2',          -->  DCLGEN LIBRARY     00026007
 //         COPYLIB='TRAIN05.CLASS.DB2',         -->  COPY LIBRARY       00027007
 //         LOADLIB='TRAIN05.CLASS.DB2.LOADLIB'  -->  LOAD LIBRARY       00028007
1                                                                                                              PAGE 0011
 MEMBER NAME  DB2LOADU
 //TRAIN05U JOB ,,CLASS=A,NOTIFY=&SYSUID                                 00001002
 //LOAD     EXEC  DSNUPROC,PARM='DSN1'                                   00002000
 //SYSIN    DD    *                                                      00003000
   LOAD DATA  INDDN SYSREC  RESUME YES                                   00003101
    INTO TABLE DEPT                                                      00003201
    ( DEPTNO   POSITION (001) CHAR(3) ,                                  00003300
      DEPTNAME POSITION (004) CHAR(36) ,                                 00003400
      MGRNO    POSITION (040) CHAR(6),                                   00003500
      ADMRDEPT POSITION (046) CHAR(3) ,                                  00003600
      LOCATION POSITION (049) CHAR(16) )                                 00003700
 //SYSREC   DD    *                                                      00004000
 A22DEPARTMENT A22                      000222A00                        00006000
 B33DEPARTMENT B33                      000444B11                        00007000
1                                                                                                              PAGE 0012
 MEMBER NAME  TESTI
 INSERT INTO MERCHANT                                                    00010000
    (ID, SEQ, ADDRESS, CITY, STATE, MSG)                                 00020000
 VALUES (20056040000, 00, '1261 NO AZUSA AVE', 'COVINA', 'CA', 'NOTES' ) 00030000
1                                                                                                              PAGE 0013
 MEMBER NAME  INDEX
 CAPSTONE INDEX
 -MERCHANT (SPUFI)
     CREATE MERCHANT TABLE WITH IN COLUMS SPECIFIED IN INSTRUCTIONS
     C1- ADDED FIRST LINE OF DATA AS A TEST
 ************************************************************************
 -KSDSM (JCL)
     PROGRAM USED: IDCAMS
     CREATE KSDS CLUSTER FOR MERCHANT DATA FROM CAPSTONE.DATA
     NOTES: USED MERCHANT ID FOR KEY
 ************************************************************************
 -KDSDP (JCL)
     PROGRAM USED: IDCAMS
     PRINTED FIRST 20 LINES OF DATA FROM CAPSTONE.KSDS.MERCHANT IN
     CHAR FORM
 ************************************************************************
 -PGMV  (COB/VSAM)
     C-1 MERCFILE INSERT AND FD
     C-2 MERCFILE WORKING STORAGE
     C-3 ADD MERCH PRINT FILE AND WS
     C-4 OPEN MERCH-KSDS
     C-5 START AT TOP OF MERCH-KSDS AND READ
         INTO MERCH REC
     C-6 MOVE FIELDS AND HEADERS
     C-7 MOVE ALL MERCH REC IN TO PRT REC
1                                                                                                              PAGE 0014
 MEMBER NAME  KSDSM
 //TRAIN05F   JOB (123),'REGGIE CALHOUN',                                00010009
 //         MSGCLASS=X,CLASS=A,NOTIFY=&SYSUID,TIME=(0,3)                 00020007
 //********************************************************************  00030000
 //*** I-P-O  I(INPUT)   P(PROCESS)   O(OUTPUT)  **********************  00040000
 //*** I - DD * TO LIST RECORDS                                ********  00050000
 //*** P - PGM=IDCAMS REPRO TO COPY                                      00060000
 //*** O - DSN= PRINT CONTENTS INTO &&TEMP DATASET                    *  00070000
 //********************************************************************  00080000
 //REPRO EXEC PGM=IDCAMS                                                 00090000
 //IDIN  DD   DSN=TRAIN05.CLASS.SIUA.CAPSTONE.DATA,DISP=SHR              00100010
 //SYSPRINT DD SYSOUT=*,OUTLIM=1000                                      00120000
 //SYSIN DD *                                                            00130000
      DELETE  (TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH)                   00131011
      DEFINE  CLUSTER                                 -                  00132003
              (                                       -                  00133003
               NAME(TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH) -            00134011
               RECORDS (100 50 )                      -                  00135003
               VOLUME(USER05)                         -                  00136009
               FSPC(20 10 )                           -                  00137003
               KEYS(13 0)                             -                  00138011
               RECORDSIZE(80 80)                      -                  00139003
                                             )                           00139103
      REPRO   INFILE(IDIN) ODS(TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH)   00140011
      PRINT   IDS(TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH) CHAR           00160011
      PRINT   IDS(TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH) HEX            00161011
      PRINT   IDS(TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH) DUMP           00162011
      LISTCAT ENTRY (TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH) ALL         00163011
 /*                                                                      00170000
 //SYSDUMP DD SYSOUT=*                                                   00180000
1                                                                                                              PAGE 0015
 MEMBER NAME  BACKUP01
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       VSAMPGM.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          01-18      ORIGINAL CODE                       00080000
 C1    *    C1            01-18      MERCFILE INSERT AND FD              00090000
 C2    *    C2            01-18      MERCFILE WORKING STORAGE            00100000
 C3    *    C3            01-19      ADD MERCH PRINT FILE AND WS         00110000
 C4    *    C4            01-19      OPEN MERCH-KSDS                     00110100
 C5    *    C5            01-19      START AT TOP OF MERCH-KSDS AND READ 00110200
       *                             INTO MERCH REC                      00110300
 C6    *    C6            01-20      MOVE FIELDS AND HEADERS             00110400
 C7    *    C7            01-21      MOVE ALL MERCH REC IN TO PRT REC    00110500
       ***************************************************************** 00111000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-MERCH-KSDS                                       00191000
       ***     OPEN MERCH-KSDS                                           00192000
       ***         1100-PROCESS-MERCH-REC                                00193000
       ***     CLOSE MERCH-KSDS                                          00194000
       *** 1110-PROCESS-MERCH-REC-DETAILS                                00195000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
       *--------------------                                             00220000
        CONFIGURATION SECTION.                                           00230000
        INPUT-OUTPUT SECTION.                                            00231000
        FILE-CONTROL.                                                    00232000
       *----- ADD SELECT FOR MERCH-KSDS 5 LINES                          00235000
 C1         SELECT MERCH-KSDS ASSIGN TO MERCFILE                         00236000
 C1                ORGANIZATION      IS INDEXED                          00237000
 C1                ACCESS MODE       IS DYNAMIC                          00238000
 C1                RECORD KEY        IS MERCH-KEY                        00239000
 C1                FILE STATUS       IS WS-MERCH-KSDS-STATUS-CODE.       00239100
 C1         SELECT MERCH-PRT-FILE ASSIGN TO PRNTMERC.                    00239200
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
 C1     FD  MERCH-KSDS                                                   00391000
 C1         RECORD CONTAINS 80 CHARACTERS.                               00392000
 C1     01  MERCH-REC.                                                   00393000
 C1         05  MERCH-KEY                      PIC X(13).                00394000
 C1         05                                 PIC X(67).                00395000
 C1     FD  MERCH-PRT-FILE                                               00396000
 C1         RECORD CONTAINS 133 CHARACTERS                               00397000
 C1         BLOCK  CONTAINS  0 RECORDS                                   00398000
 C1         RECORDING  MODE IS F.                                        00399000
 C1     01  MERCH-PRT-REC      PIC X(133).                               00399100
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
1                                                                                                              PAGE 0016
 MEMBER NAME  BACKUP01
       ********* WS - OUR DATA NAMES *******************                 00420000
 C2     01  WS-MERCH-REC.                                                00430000
 C2       05  WS-MERCH-REC-MERCH-ID          PIC X(13).                  00440000
 C2       05  WS-MERCH-REC-MERCH-SEQ         PIC X(02).                  00450000
 C2       05  WS-MERCH-REC-MERCH-ADDRESS     PIC X(24).                  00451000
 C2       05  WS-MERCH-REC-MERCH-CITY        PIC X(21).                  00452000
 C2       05  WS-MERCH-REC-MERCH-STATE       PIC X(02).                  00453000
 C2       05  WS-MERCH-REC-MERCH-MSG         PIC X(05).                  00454000
 C2       05                                 PIC X(13) VALUE SPACES.     00454100
                                                                         00455000
        01  WS-MERCH-PRT-LINE-COUNT  PIC 9(2)     VALUE 0.               00455100
        01  WS-MERCH-PRT-PAGE-COUNT  PIC 9(5)     VALUE 0.               00455200
        01  WS-MERCH-PRT-HDR1.                                           00455300
          05  FILLER               PIC X(20)     VALUE SPACES.           00455400
          05                       PIC X(17) VALUE '-MERCHANT RECORD-'.  00455500
          05                       PIC X(20)     VALUE SPACES.           00455600
          05                       PIC X(10)     VALUE 'PAGE NO:'.       00455700
          05  WS-MERCH-PRT-HDR1-PAGE-COUNT PIC ZZZZ9.                    00455800
          05                        PIC X(21)     VALUE SPACES.          00455900
        01  WS-MERCH-PRT-HDR2.                                           00456000
          05                         PIC X(05)       VALUE SPACES.       00456100
          05                         PIC X(13)  VALUE 'MERCH. ID'.       00456200
          05                         PIC X(05)       VALUE SPACES.       00456300
          05                         PIC X(10) VALUE 'MERCH. SEQ'.       00456400
          05                         PIC X(05)       VALUE SPACES.       00456500
          05                         PIC X(24)    VALUE 'ADDRESS'.       00456600
          05                         PIC X(05)       VALUE SPACES.       00456800
          05                         PIC X(21)       VALUE 'CITY'.       00456900
          05                         PIC X(05)       VALUE SPACES.       00457000
          05                         PIC X(05)       VALUE 'STATE'.      00457100
          05                         PIC X(05)       VALUE SPACES.       00457200
          05                         PIC X(05)       VALUE 'MSG'.        00457300
          05                         PIC X(28)       VALUE SPACES.       00457400
        01  WS-MERCH-PRT-REC.                                            00457500
          05                         PIC X(05)       VALUE SPACES.       00457600
          05  WS-MERCH-PRT-ID        PIC X(13).                          00457700
          05                         PIC X(05)       VALUE SPACES.       00457800
          05  WS-MERCH-PRT-SEQ       PIC X(10).                          00457900
          05                         PIC X(05)   VALUE SPACES.           00458000
          05  WS-MERCH-PRT-ADDRESS   PIC X(24).                          00458100
          05                         PIC X(05)   VALUE SPACES.           00458200
          05  WS-MERCH-PRT-CITY      PIC X(21).                          00458300
          05                         PIC X(05)   VALUE SPACES.           00458400
          05  WS-MERCH-PRT-STATE     PIC X(02).                          00458500
          05                         PIC X(05)   VALUE SPACES.           00458600
          05  WS-MERCH-PRT-MSG       PIC X(05).                          00458700
          05                         PIC X(28)   VALUE SPACES.           00458800
                                                                         00458900
        01 WS-MERCH-KSDS-STATUS-CODE          PIC X(02).                 00459000
        01 WS-INPUT-SWITCH                    PIC X(01) VALUE 'Y'.       00459100
               88 NO-MORE-INPUT       VALUE 'N'.                         00459200
               88 MORE-INPUT          VALUE 'Y'.                         00459300
        LINKAGE SECTION.                                                 00460000
        PROCEDURE DIVISION.                                              00470000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
1                                                                                                              PAGE 0017
 MEMBER NAME  BACKUP01
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-MERCH-KSDS                              00540000
                THRU 1000-EXIT                                           00550000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00600000
 C4    **********************************************************        00972900
  V    *********************************************************         00973000
  |    **********************************************************        00973100
  |     1000-PROCESS-MERCH-KSDS.                                         00973200
  |    **********************************************************        00973300
  |    ***  OPEN THE MERCH FILE TO ALLOW FOR PROCESSING   **             00973400
  |    ***  PROCESS THE MERCH FILE IN THE 1000- PARAGRAPH **             00974000
  |    ***  CLOSE THE MERCH FILE WHEN THE PROCESSING IN        **        00975000
  |    ***      PARAGRAPH 1100- IS FINISHED                    **        00976000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00977000
  |    **********************************************************        00978000
  |         DISPLAY '1000-PROCESS-MERCH-KSDS'                            00979000
  |                                                                      00979100
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00979200
 C6         MOVE 0 TO WS-MERCH-PRT-PAGE-COUNT                            00979300
 C6         MOVE 10 TO WS-MERCH-PRT-LINE-COUNT                           00979400
  |         OPEN I-O MERCH-KSDS                                          00979500
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00979600
  |            CONTINUE                                                  00979700
  |         ELSE DISPLAY 'OPEN-WS-MERCH-KSDS-STATUS-CODE='               00979800
  |                       WS-MERCH-KSDS-STATUS-CODE                      00979900
  |          END-IF                                                      00980000
  |         DISPLAY '**** S-T-A-R-T OF MERCH FILE****'                   00980500
  |         DISPLAY ' '                                                  00980600
  |    ********* USE OPEN OUTPUT TO READ A PRINT *********************** 00980700
  |         OPEN OUTPUT MERCH-PRT-FILE                                   00980800
  |    ********* MOVE SPACES    RESET INPUT-SWITCH      INDICATOR ****** 00981700
  |         MOVE SPACES  TO  WS-INPUT-SWITCH                             00981800
  |                                                                      00981900
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00982000
  |         PERFORM 1100-PROCESS-MERCH-REC                               00982100
  |                  UNTIL WS-INPUT-SWITCH = 'N'                         00982200
  |                                                                      00982300
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00983000
  |         CLOSE MERCH-KSDS                                             00984000
  |         DISPLAY ' '                                                  00985000
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00985100
  |            CONTINUE                                                  00985200
  |         ELSE DISPLAY 'CLOSE-WS-MERCH-KSDS-STATUS-CODE='              00985300
  |                       WS-MERCH-KSDS-STATUS-CODE                      00985400
  |         DISPLAY '****  E-N-D OF MERCH FILE ****'                     00986000
  |         WRITE MERCH-PRT-REC                                          00986100
  |         CLOSE MERCH-PRT-FILE                                         00986300
  _         .                                                            00988000
       ***********************************************************       00991300
       ***********************************************************       00991400
       ***********************************************************       00991500
 C5                                                                      00991600
  V     1100-PROCESS-MERCH-REC.                                          00991700
  |    **********************************************************        00991800
1                                                                                                              PAGE 0018
 MEMBER NAME  BACKUP01
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  *********        00991900
  |    **********************************************************        00992000
  |    *    DISPLAY '1100-PROCESS-MERCH-REC' ********************        00992100
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *****        00992300
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS ******        00992400
  |    ********* MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM *        00992500
             MOVE   LOW-VALUES          TO MERCH-KEY                     00992700
             START MERCH-KSDS     KEY IS > MERCH-KEY                     00992800
             IF WS-MERCH-KSDS-STATUS-CODE = '00'                         00992900
                CONTINUE                                                 00993000
             ELSE DISPLAY 'START ERROR   -   WS-MERCH-KSDS-STATUS-CODE'  00993100
                           WS-MERCH-KSDS-STATUS-CODE                     00993200
             END-IF                                                      00993300
  |    **********************************************************        00993500
  |    ** = GOES AFTER NOT AND BEFORE SPACE *********************        00993600
  |    **********************************************************        00993700
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00993800
  |    **********************************************************        00993900
  |    ***END WITH "END-IF" STATEMENT****************************        00994000
  |    **********************************************************        00994100
            READ MERCH-KSDS NEXT INTO WS-MERCH-REC                       00994300
                 PERFORM UNTIL WS-INPUT-SWITCH = 'N'                     00994400
 C5              IF WS-MERCH-KSDS-STATUS-CODE = '00'                     00994500
 C5                 CONTINUE                                             00994600
 C5              ELSE DISPLAY 'READ-WS-MERCH-KSDS-STATUS-CODE='          00994700
 C5                         WS-MERCH-KSDS-STATUS-CODE                    00994800
                    PERFORM 1000-EXIT                                    00994900
 C5              END-IF                                                  00995000
  |           IF WS-MERCH-REC-MERCH-ID NOT = SPACE                       00996000
  |                 DISPLAY 'WS-MERCH-REC-MERCH-ID='                     00997000
  |                            WS-MERCH-REC-MERCH-ID                     00998000
  |                 DISPLAY 'WS-MERCH-REC-MERCH-SEQ='                    00999000
  |                            WS-MERCH-REC-MERCH-SEQ                    00999100
  |                 DISPLAY 'WS-MERCH-REC-MERCH-ADDRESS='                00999200
  |                            WS-MERCH-REC-MERCH-ADDRESS                00999300
  |                 DISPLAY 'WS-MERCH-REC-MERCH-CITY='                   00999400
  |                            WS-MERCH-REC-MERCH-CITY                   00999500
  |                 DISPLAY 'WS-MERCH-REC-MERCH-STATE='                  00999600
  |                            WS-MERCH-REC-MERCH-STATE                  00999700
  |                 DISPLAY 'WS-MERCH-REC-MERCH-MSG='                    00999800
  |                            WS-MERCH-REC-MERCH-MSG                    00999900
  |                 PERFORM 1110-MOVE-WRITE-MERCH-REC                    01001200
  |               ELSE                                                   01001300
  |                 DISPLAY 'BAD RECORD'                                 01001400
  >           END-IF                                                     01001500
  -         .                                                            01008000
 C6     1110-MOVE-WRITE-MERCH-REC.                                       01008100
  V    **********************************************************        01008200
  |    ****PERFORMING MOVE AND WRIT STATED ABOVE****************         01008300
  |    **********************************************************        01008400
  |         DISPLAY  '1110-MOVE-WRITE-MERCH-REC'                         01008500
  |         DISPLAY  WS-MERCH-REC                                        01008600
  V    **********************************************************        01008700
  |    ****IF STATEMENTS FOR LINE COUNT**************************        01008800
  |    **********************************************************        01008900
            IF   WS-MERCH-PRT-LINE-COUNT > 11                            01009000
  |         THEN     PERFORM 1112-WRITE-PRT-MERCH-HDRS                   01010000
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020000
1                                                                                                              PAGE 0019
 MEMBER NAME  BACKUP01
  |         ELSE                                                         01020100
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020200
  |         END-IF                                                       01020300
  _         .                                                            01020400
       ****************************************************************  01020500
       ****************************************************************  01020700
       ****************************************************************  01020800
 C7     1111-MOVE-FLDS-WRITE-MERCH-DTL.                                  01020900
  V         DISPLAY '1111-MOVE-FLDS-WRITE-MERCH-DTL'                     01021000
  |         MOVE  WS-MERCH-REC-MERCH-ID TO WS-MERCH-PRT-ID               01021100
  |         MOVE  WS-MERCH-REC-MERCH-SEQ TO WS-MERCH-PRT-SEQ             01021200
  |         MOVE  WS-MERCH-REC-MERCH-ADDRESS TO WS-MERCH-PRT-ADDRESS     01021400
            MOVE  WS-MERCH-REC-MERCH-CITY TO WS-MERCH-PRT-CITY           01021500
            MOVE  WS-MERCH-REC-MERCH-STATE TO WS-MERCH-PRT-STATE         01021600
            MOVE  WS-MERCH-REC-MERCH-MSG TO WS-MERCH-PRT-MSG             01021700
  |         ADD      1                  TO WS-MERCH-PRT-LINE-COUNT       01021800
  |         WRITE MERCH-PRT-REC       FROM WS-MERCH-PRT-REC AFTER 2 LINE 01021900
  |         .                                                            01022000
  |     1112-WRITE-PRT-MERCH-HDRS.                                       01022100
  |         DISPLAY '1112-WRITE-PRT-MERCH-HDRS'                          01022200
  |         ADD          1       TO WS-MERCH-PRT-PAGE-COUNT              01022300
  |         MOVE   WS-MERCH-PRT-PAGE-COUNT                               01022400
            TO WS-MERCH-PRT-HDR1-PAGE-COUNT                              01022500
  |         MOVE         0       TO WS-MERCH-PRT-LINE-COUNT              01022600
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR1 AFTER PAGE       01022700
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR2 AFTER 2 LINES    01022800
  _         .                                                            01022900
        1000-EXIT.                                                       01023000
            EXIT                                                         01024000
            .                                                            01025000
1                                                                                                              PAGE 0020
 MEMBER NAME  BACKUPO2
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       VSAMPGM.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          01-18      ORIGINAL CODE                       00080000
 C1    *    C1            01-18      MERCFILE INSERT AND FD              00090000
 C2    *    C2            01-18      MERCFILE WORKING STORAGE            00100000
 C3    *    C3            01-19      ADD MERCH PRINT FILE AND WS         00110000
 C4    *    C4            01-19      OPEN MERCH-KSDS                     00110100
 C5    *    C5            01-19      START AT TOP OF MERCH-KSDS AND READ 00110200
       *                             INTO MERCH REC                      00110300
 C6    *    C6            01-20      MOVE FIELDS AND HEADERS             00110400
 C7    *    C7            01-21      MOVE ALL MERCH REC IN TO PRT REC    00110500
       ***************************************************************** 00111000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-MERCH-KSDS                                       00191000
       ***     OPEN MERCH-KSDS                                           00192000
       ***         1100-PROCESS-MERCH-REC                                00193000
       ***     CLOSE MERCH-KSDS                                          00194000
       *** 1110-PROCESS-MERCH-REC-DETAILS                                00195000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
       *--------------------                                             00220000
        CONFIGURATION SECTION.                                           00230000
        INPUT-OUTPUT SECTION.                                            00231000
        FILE-CONTROL.                                                    00232000
       *----- ADD SELECT FOR MERCH-KSDS 5 LINES                          00235000
 C1         SELECT MERCH-KSDS ASSIGN TO MERCFILE                         00236000
 C1                ORGANIZATION      IS INDEXED                          00237000
 C1                ACCESS MODE       IS DYNAMIC                          00238000
 C1                RECORD KEY        IS MERCH-KEY                        00239000
 C1                FILE STATUS       IS WS-MERCH-KSDS-STATUS-CODE.       00239100
 C1         SELECT MERCH-PRT-FILE ASSIGN TO PRNTMERC.                    00239200
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
 C1     FD  MERCH-KSDS                                                   00391000
 C1         RECORD CONTAINS 80 CHARACTERS.                               00392000
 C1     01  MERCH-REC.                                                   00393000
 C1         05  MERCH-KEY                      PIC X(13).                00394000
 C1         05                                 PIC X(67).                00395000
 C1     FD  MERCH-PRT-FILE                                               00396000
 C1         RECORD CONTAINS 133 CHARACTERS                               00397000
 C1         BLOCK  CONTAINS  0 RECORDS                                   00398000
 C1         RECORDING  MODE IS F.                                        00399000
 C1     01  MERCH-PRT-REC      PIC X(133).                               00399100
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
1                                                                                                              PAGE 0021
 MEMBER NAME  BACKUPO2
       ********* WS - OUR DATA NAMES *******************                 00420000
 C2     01  WS-MERCH-REC.                                                00430000
 C2       05  WS-MERCH-REC-MERCH-ID          PIC X(13).                  00440000
 C2       05  WS-MERCH-REC-MERCH-SEQ         PIC X(02).                  00450000
 C2       05  WS-MERCH-REC-MERCH-ADDRESS     PIC X(24).                  00451000
 C2       05  WS-MERCH-REC-MERCH-CITY        PIC X(21).                  00452000
 C2       05  WS-MERCH-REC-MERCH-STATE       PIC X(02).                  00453000
 C2       05  WS-MERCH-REC-MERCH-MSG         PIC X(05).                  00454000
 C2       05                                 PIC X(13) VALUE SPACES.     00454100
                                                                         00455000
        01  WS-MERCH-PRT-LINE-COUNT  PIC 9(2)     VALUE 0.               00455100
        01  WS-MERCH-PRT-PAGE-COUNT  PIC 9(5)     VALUE 0.               00455200
        01  WS-MERCH-PRT-HDR1.                                           00455300
          05  FILLER               PIC X(20)     VALUE SPACES.           00455400
          05                       PIC X(17) VALUE '-MERCHANT RECORD-'.  00455500
          05                       PIC X(20)     VALUE SPACES.           00455600
          05                       PIC X(10)     VALUE 'PAGE NO:'.       00455700
          05  WS-MERCH-PRT-HDR1-PAGE-COUNT PIC ZZZZ9.                    00455800
          05                        PIC X(21)     VALUE SPACES.          00455900
        01  WS-MERCH-PRT-HDR2.                                           00456000
          05                         PIC X(05)       VALUE SPACES.       00456100
          05                         PIC X(13)  VALUE 'MERCH. ID'.       00456200
          05                         PIC X(05)       VALUE SPACES.       00456300
          05                         PIC X(10) VALUE 'MERCH. SEQ'.       00456400
          05                         PIC X(05)       VALUE SPACES.       00456500
          05                         PIC X(24)    VALUE 'ADDRESS'.       00456600
          05                         PIC X(05)       VALUE SPACES.       00456800
          05                         PIC X(21)       VALUE 'CITY'.       00456900
          05                         PIC X(05)       VALUE SPACES.       00457000
          05                         PIC X(05)       VALUE 'STATE'.      00457100
          05                         PIC X(05)       VALUE SPACES.       00457200
          05                         PIC X(05)       VALUE 'MSG'.        00457300
          05                         PIC X(28)       VALUE SPACES.       00457400
        01  WS-MERCH-PRT-REC.                                            00457500
          05                         PIC X(05)       VALUE SPACES.       00457600
          05  WS-MERCH-PRT-ID        PIC X(13).                          00457700
          05                         PIC X(05)       VALUE SPACES.       00457800
          05  WS-MERCH-PRT-SEQ       PIC X(10).                          00457900
          05                         PIC X(05)   VALUE SPACES.           00458000
          05  WS-MERCH-PRT-ADDRESS   PIC X(24).                          00458100
          05                         PIC X(05)   VALUE SPACES.           00458200
          05  WS-MERCH-PRT-CITY      PIC X(21).                          00458300
          05                         PIC X(05)   VALUE SPACES.           00458400
          05  WS-MERCH-PRT-STATE     PIC X(02).                          00458500
          05                         PIC X(05)   VALUE SPACES.           00458600
          05  WS-MERCH-PRT-MSG       PIC X(05).                          00458700
          05                         PIC X(28)   VALUE SPACES.           00458800
                                                                         00458900
        01 WS-MERCH-KSDS-STATUS-CODE          PIC X(02).                 00459000
        01 WS-INPUT-SWITCH                    PIC X(01) VALUE 'Y'.       00459100
               88 NO-MORE-INPUT       VALUE 'N'.                         00459200
               88 MORE-INPUT          VALUE 'Y'.                         00459300
        LINKAGE SECTION.                                                 00460000
        PROCEDURE DIVISION.                                              00470000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
1                                                                                                              PAGE 0022
 MEMBER NAME  BACKUPO2
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-MERCH-KSDS                              00540000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00600000
 C4    **********************************************************        00972900
  V    *********************************************************         00973000
  |    **********************************************************        00973100
  |     1000-PROCESS-MERCH-KSDS.                                         00973200
  |    **********************************************************        00973300
  |    ***  OPEN THE MERCH FILE TO ALLOW FOR PROCESSING   **             00973400
  |    ***  PROCESS THE MERCH FILE IN THE 1000- PARAGRAPH **             00974000
  |    ***  CLOSE THE MERCH FILE WHEN THE PROCESSING IN        **        00975000
  |    ***      PARAGRAPH 1100- IS FINISHED                    **        00976000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00977000
  |    **********************************************************        00978000
  |         DISPLAY '1000-PROCESS-MERCH-KSDS'                            00979000
  |                                                                      00979100
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00979200
 C6         MOVE 0 TO  WS-MERCH-PRT-PAGE-COUNT                           00979300
 C6         MOVE 10 TO WS-MERCH-PRT-LINE-COUNT                           00979400
  |         OPEN I-O   MERCH-KSDS                                        00979500
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00979600
  |            CONTINUE                                                  00979700
  |         ELSE DISPLAY 'OPEN-WS-MERCH-KSDS-STATUS-CODE='               00979800
  |                       WS-MERCH-KSDS-STATUS-CODE                      00979900
  |          END-IF                                                      00980000
  |         DISPLAY '**** S-T-A-R-T OF MERCH FILE****'                   00980500
  |         DISPLAY ' '                                                  00980600
  |    ********* USE OPEN OUTPUT TO READ A PRINT *********************** 00980700
  |         OPEN OUTPUT MERCH-PRT-FILE                                   00980800
  |    ********* MOVE SPACES    RESET INPUT-SWITCH      INDICATOR ****** 00981700
  |         MOVE SPACES  TO  WS-INPUT-SWITCH                             00981800
  |                                                                      00981900
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00982000
  |         PERFORM 1100-PROCESS-MERCH-REC                               00982100
  |                  UNTIL WS-INPUT-SWITCH = 'N'                         00982200
  |                                                                      00982300
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00983000
  |         CLOSE MERCH-KSDS                                             00984000
  |         DISPLAY ' '                                                  00985000
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00985100
  |            CONTINUE                                                  00985200
  |         ELSE DISPLAY 'CLOSE-WS-MERCH-KSDS-STATUS-CODE='              00985300
  |                       WS-MERCH-KSDS-STATUS-CODE                      00985400
  |         DISPLAY '****  E-N-D OF MERCH FILE ****'                     00986000
  |         WRITE MERCH-PRT-REC                                          00986100
  |         CLOSE MERCH-PRT-FILE                                         00986300
  _         .                                                            00988000
       ***********************************************************       00991300
       ***********************************************************       00991400
       ***********************************************************       00991500
 C5                                                                      00991600
  V     1100-PROCESS-MERCH-REC.                                          00991700
  |    **********************************************************        00991800
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  *********        00991900
1                                                                                                              PAGE 0023
 MEMBER NAME  BACKUPO2
  |    **********************************************************        00992000
  |         DISPLAY '1100-PROCESS-MERCH-REC'                             00992100
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *****        00992300
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS ******        00992400
  |    ********* MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM *        00992500
             MOVE   LOW-VALUES          TO MERCH-KEY                     00992700
             START MERCH-KSDS     KEY IS > MERCH-KEY                     00992800
             IF WS-MERCH-KSDS-STATUS-CODE = '00'                         00992900
                CONTINUE                                                 00993000
             ELSE DISPLAY 'START ERROR   -   WS-MERCH-KSDS-STATUS-CODE'  00993100
                           WS-MERCH-KSDS-STATUS-CODE                     00993200
             END-IF                                                      00993300
             MOVE '00'     TO WS-MERCH-KSDS-STATUS-CODE                  00993400
             PERFORM UNTIL WS-MERCH-KSDS-STATUS-CODE NOT EQUAL '00'      00993500
  |    **********************************************************        00993600
  |    ** = GOES AFTER NOT AND BEFORE SPACE *********************        00993700
  |    **********************************************************        00993800
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00993900
  |    **********************************************************        00994000
  |    ***END WITH "END-IF" STATEMENT****************************        00994100
  |    **********************************************************        00994200
                 READ MERCH-KSDS NEXT INTO WS-MERCH-REC                  00994300
 C5              IF WS-MERCH-KSDS-STATUS-CODE = '00'                     00994500
                   DISPLAY 'WS-MERCH-REC-MERCH-ID='                      00997000
                            WS-MERCH-REC-MERCH-ID                        00998000
                   DISPLAY 'WS-MERCH-REC-MERCH-SEQ='                     00999000
                            WS-MERCH-REC-MERCH-SEQ                       00999100
                   DISPLAY 'WS-MERCH-REC-MERCH-ADDRESS='                 00999200
                            WS-MERCH-REC-MERCH-ADDRESS                   00999300
                   DISPLAY 'WS-MERCH-REC-MERCH-CITY='                    00999400
                            WS-MERCH-REC-MERCH-CITY                      00999500
                   DISPLAY 'WS-MERCH-REC-MERCH-STATE='                   00999600
                            WS-MERCH-REC-MERCH-STATE                     00999700
                   DISPLAY 'WS-MERCH-REC-MERCH-MSG='                     00999800
                            WS-MERCH-REC-MERCH-MSG                       00999900
                   PERFORM  1110-MOVE-WRITE-MERCH-REC                    01001200
 C5              ELSE DISPLAY 'READ-WS-MERCH-KSDS-STATUS-CODE='          01001300
                          WS-MERCH-KSDS-STATUS-CODE                      01001400
                 END-IF                                                  01001500
  >          END-PERFORM                                                 01001800
  -         .                                                            01008000
 C6     1110-MOVE-WRITE-MERCH-REC.                                       01008100
  V    **********************************************************        01008200
  |    ****PERFORMING MOVE AND WRIT STATED ABOVE****************         01008300
  |    **********************************************************        01008400
  |         DISPLAY  '1110-MOVE-WRITE-MERCH-REC'                         01008500
  |         DISPLAY  WS-MERCH-REC                                        01008600
  V    **********************************************************        01008700
  |    ****IF STATEMENTS FOR LINE COUNT**************************        01008800
  |    **********************************************************        01008900
            IF   WS-MERCH-PRT-LINE-COUNT > 11                            01009000
  |         THEN     PERFORM 1112-WRITE-PRT-MERCH-HDRS                   01010000
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020000
  |         ELSE                                                         01020100
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020200
  |         END-IF                                                       01020300
  _         .                                                            01020400
       ****************************************************************  01020500
1                                                                                                              PAGE 0024
 MEMBER NAME  BACKUPO2
       ****************************************************************  01020700
       ****************************************************************  01020800
 C7     1111-MOVE-FLDS-WRITE-MERCH-DTL.                                  01020900
  V         DISPLAY '1111-MOVE-FLDS-WRITE-MERCH-DTL'                     01021000
  |         MOVE  WS-MERCH-REC-MERCH-ID TO WS-MERCH-PRT-ID               01021100
  |         MOVE  WS-MERCH-REC-MERCH-SEQ TO WS-MERCH-PRT-SEQ             01021200
  |         MOVE  WS-MERCH-REC-MERCH-ADDRESS TO WS-MERCH-PRT-ADDRESS     01021400
            MOVE  WS-MERCH-REC-MERCH-CITY TO WS-MERCH-PRT-CITY           01021500
            MOVE  WS-MERCH-REC-MERCH-STATE TO WS-MERCH-PRT-STATE         01021600
            MOVE  WS-MERCH-REC-MERCH-MSG TO WS-MERCH-PRT-MSG             01021700
  |         ADD      1                  TO WS-MERCH-PRT-LINE-COUNT       01021800
  |         WRITE MERCH-PRT-REC       FROM WS-MERCH-PRT-REC AFTER 2 LINE 01021900
  |         .                                                            01022000
  |     1112-WRITE-PRT-MERCH-HDRS.                                       01022100
  |         DISPLAY '1112-WRITE-PRT-MERCH-HDRS'                          01022200
  |         ADD          1       TO WS-MERCH-PRT-PAGE-COUNT              01022300
  |         MOVE   WS-MERCH-PRT-PAGE-COUNT                               01022400
            TO WS-MERCH-PRT-HDR1-PAGE-COUNT                              01022500
  |         MOVE         0       TO WS-MERCH-PRT-LINE-COUNT              01022600
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR1 AFTER PAGE       01022700
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR2 AFTER 2 LINES    01022800
  _         .                                                            01022900
1                                                                                                              PAGE 0025
 MEMBER NAME  PGMV
        IDENTIFICATION DIVISION.                                         00010001
        PROGRAM-ID.       VSAMPGM.                                       00020068
       ***************************************************************** 00030002
       ***********    CHANGE LOG   ************************************* 00040002
       *---------------------------------------------------------------* 00050002
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060002
       *---------------------------------------------------------------* 00070002
       *    NONE          01-18      ORIGINAL CODE                       00080068
 C1    *    C1            01-18      MERCFILE INSERT AND FD              00090070
 C2    *    C2            01-18      MERCFILE WORKING STORAGE            00100070
 C3    *    C3            01-19      ADD MERCH PRINT FILE AND WS         00110088
 C4    *    C4            01-19      OPEN MERCH-KSDS                     00110188
 C5    *    C5            01-19      START AT TOP OF MERCH-KSDS AND READ 00110288
       *                             INTO MERCH REC                      00110388
 C6    *    C6            01-20      MOVE FIELDS AND HEADERS             00110496
 C7    *    C7            01-21      MOVE ALL MERCH REC IN TO PRT REC    00110596
       ***************************************************************** 00111041
       *******  PROGRAM STRUCTURE    *********************************** 00120002
       ***************************************************************** 00130002
       *** 0000-MAIN.                                                    00140002
       *** 1000-PROCESS-MERCH-KSDS                                       00191069
       ***     OPEN MERCH-KSDS                                           00192069
       ***         1100-PROCESS-MERCH-REC                                00193068
       ***     CLOSE MERCH-KSDS                                          00194069
       *** 1110-PROCESS-MERCH-REC-DETAILS                                00195068
       ***************************************************************** 00200002
        ENVIRONMENT DIVISION.                                            00210068
       *--------------------                                             00220068
        CONFIGURATION SECTION.                                           00230068
        INPUT-OUTPUT SECTION.                                            00231068
        FILE-CONTROL.                                                    00232068
       *----- ADD SELECT FOR MERCH-KSDS 5 LINES                          00235068
 C1         SELECT MERCH-KSDS ASSIGN TO MERCFILE                         00236070
 C1                ORGANIZATION      IS INDEXED                          00237068
 C1                ACCESS MODE       IS DYNAMIC                          00238068
 C1                RECORD KEY        IS MERCH-KEY                        00239068
 C1                FILE STATUS       IS WS-MERCH-KSDS-STATUS-CODE.       00239168
 C1         SELECT MERCH-PRT-FILE ASSIGN TO PRNTMERC.                    00239296
       **********************************************************        00240002
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250002
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260002
       **********************************************************        00270002
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290002
        DATA DIVISION.                                                   00300002
        FILE SECTION.                                                    00310016
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390002
 C1     FD  MERCH-KSDS                                                   00391068
 C1         RECORD CONTAINS 80 CHARACTERS.                               00392068
 C1     01  MERCH-REC.                                                   00393068
 C1         05  MERCH-KEY                      PIC X(13).                00394068
 C1         05                                 PIC X(67).                00395068
 C1     FD  MERCH-PRT-FILE                                               00396096
 C1         RECORD CONTAINS 133 CHARACTERS                               00397096
 C1         BLOCK  CONTAINS  0 RECORDS                                   00398096
 C1         RECORDING  MODE IS F.                                        00399096
 C1     01  MERCH-PRT-REC      PIC X(133).                               00399196
                                                                         00400002
        WORKING-STORAGE SECTION.                                         00410002
1                                                                                                              PAGE 0026
 MEMBER NAME  PGMV
       ********* WS - OUR DATA NAMES *******************                 00420002
 C2     01  WS-MERCH-REC.                                                00430068
 C2       05  WS-MERCH-REC-MERCH-ID          PIC X(13).                  00440079
 C2       05  WS-MERCH-REC-MERCH-SEQ         PIC X(02).                  00450079
 C2       05  WS-MERCH-REC-MERCH-ADDRESS     PIC X(24).                  00451068
 C2       05  WS-MERCH-REC-MERCH-CITY        PIC X(21).                  00452068
 C2       05  WS-MERCH-REC-MERCH-STATE       PIC X(02).                  00453068
 C2       05  WS-MERCH-REC-MERCH-MSG         PIC X(05).                  00454068
 C2       05                                 PIC X(13) VALUE SPACES.     00454168
                                                                         00455068
        01  WS-MERCH-PRT-LINE-COUNT  PIC 9(2)     VALUE 0.               00455168
        01  WS-MERCH-PRT-PAGE-COUNT  PIC 9(5)     VALUE 0.               00455268
        01  WS-MERCH-PRT-HDR1.                                           00455368
          05  FILLER               PIC X(20)     VALUE SPACES.           00455468
          05                       PIC X(17) VALUE '-MERCHANT RECORD-'.  00455568
          05                       PIC X(20)     VALUE SPACES.           00455668
          05                       PIC X(10)     VALUE 'PAGE NO:'.       00455768
          05  WS-MERCH-PRT-HDR1-PAGE-COUNT PIC ZZZZ9.                    00455868
          05                        PIC X(21)     VALUE SPACES.          00455968
        01  WS-MERCH-PRT-HDR2.                                           00456068
          05                         PIC X(05)       VALUE SPACES.       00456172
          05                         PIC X(13)  VALUE 'MERCH. ID'.       00456272
          05                         PIC X(05)       VALUE SPACES.       00456368
          05                         PIC X(10) VALUE 'MERCH. SEQ'.       00456472
          05                         PIC X(05)       VALUE SPACES.       00456568
          05                         PIC X(24)    VALUE 'ADDRESS'.       00456671
          05                         PIC X(05)       VALUE SPACES.       00456868
          05                         PIC X(21)       VALUE 'CITY'.       00456971
          05                         PIC X(05)       VALUE SPACES.       00457071
          05                         PIC X(05)       VALUE 'STATE'.      00457172
          05                         PIC X(05)       VALUE SPACES.       00457271
          05                         PIC X(05)       VALUE 'MSG'.        00457371
          05                         PIC X(28)       VALUE SPACES.       00457472
        01  WS-MERCH-PRT-REC.                                            00457571
          05                         PIC X(05)       VALUE SPACES.       00457671
          05  WS-MERCH-PRT-ID        PIC X(13).                          00457771
          05                         PIC X(05)       VALUE SPACES.       00457871
          05  WS-MERCH-PRT-SEQ       PIC X(10).                          00457972
          05                         PIC X(05)   VALUE SPACES.           00458071
          05  WS-MERCH-PRT-ADDRESS   PIC X(24).                          00458171
          05                         PIC X(05)   VALUE SPACES.           00458271
          05  WS-MERCH-PRT-CITY      PIC X(21).                          00458371
          05                         PIC X(05)   VALUE SPACES.           00458471
          05  WS-MERCH-PRT-STATE     PIC X(02).                          00458571
          05                         PIC X(05)   VALUE SPACES.           00458671
          05  WS-MERCH-PRT-MSG       PIC X(05).                          00458771
          05                         PIC X(28)   VALUE SPACES.           00458872
                                                                         00458971
        01 WS-MERCH-KSDS-STATUS-CODE          PIC X(02).                 00459071
        01 WS-INPUT-SWITCH                    PIC X(01) VALUE 'Y'.       00459171
               88 NO-MORE-INPUT       VALUE 'N'.                         00459271
               88 MORE-INPUT          VALUE 'Y'.                         00459371
        LINKAGE SECTION.                                                 00460042
        PROCEDURE DIVISION.                                              00470068
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480002
        0000-MAIN.                                                       00490002
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500002
            DISPLAY '0000-MAIN'                                          00510002
1                                                                                                              PAGE 0027
 MEMBER NAME  PGMV
                                                                         00520002
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530002
            PERFORM 1000-PROCESS-MERCH-KSDS                              00540069
       ********* GOBACK - RETURN TO Z/OS ****************                00560002
            GOBACK                                                       00570002
            .                                                            00580002
                                                                         00600002
 C4    **********************************************************        00972996
  V    *********************************************************         00973028
  |    **********************************************************        00973127
  |     1000-PROCESS-MERCH-KSDS.                                         00973269
  |    **********************************************************        00973327
  |    ***  OPEN THE MERCH FILE TO ALLOW FOR PROCESSING   **             00973468
  |    ***  PROCESS THE MERCH FILE IN THE 1000- PARAGRAPH **             00974068
  |    ***  CLOSE THE MERCH FILE WHEN THE PROCESSING IN        **        00975068
  |    ***      PARAGRAPH 1100- IS FINISHED                    **        00976068
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00977027
  |    **********************************************************        00978028
  |         DISPLAY '1000-PROCESS-MERCH-KSDS'                            00979069
  |                                                                      00979122
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00979222
 C6         MOVE 0 TO  WS-MERCH-PRT-PAGE-COUNT                           00979399
 C6         MOVE 30 TO WS-MERCH-PRT-LINE-COUNT                           00979499
  |         OPEN I-O   MERCH-KSDS                                        00979599
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00979696
  |            CONTINUE                                                  00979796
  |         ELSE DISPLAY 'OPEN-WS-MERCH-KSDS-STATUS-CODE='               00979896
  |                       WS-MERCH-KSDS-STATUS-CODE                      00979996
  |          END-IF                                                      00980096
  |         DISPLAY '**** S-T-A-R-T OF MERCH FILE****'                   00980568
  |         DISPLAY ' '                                                  00980642
  |    ********* USE OPEN OUTPUT TO READ A PRINT *********************** 00980769
  |         OPEN OUTPUT MERCH-PRT-FILE                                   00980869
  |                                                                      00981942
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00982042
  |         PERFORM 1100-PROCESS-MERCH-REC                               00982199
  |                  UNTIL WS-MERCH-KSDS-STATUS-CODE = '10'              00982299
  |                                                                      00982342
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00983022
  |         CLOSE MERCH-KSDS                                             00984069
  |         DISPLAY ' '                                                  00985042
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00985196
               DISPLAY 'MERCH-KSDS CLOSE STATUS='                        00985299
                        WS-MERCH-KSDS-STATUS-CODE                        00985399
  |            CONTINUE                                                  00985496
  |         ELSE DISPLAY 'CLOSE-WS-MERCH-KSDS-STATUS-CODE='              00985596
  |                       WS-MERCH-KSDS-STATUS-CODE                      00985696
  |         DISPLAY '****  E-N-D OF MERCH FILE ****'                     00986068
  |         WRITE MERCH-PRT-REC                                          00986196
  |         CLOSE MERCH-PRT-FILE                                         00986396
  _         .                                                            00988042
       ***********************************************************       00991342
       ***********************************************************       00991442
       ***********************************************************       00991542
 C5                                                                      00991696
  V     1100-PROCESS-MERCH-REC.                                          00991796
  |    **********************************************************        00991842
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  *********        00991969
1                                                                                                              PAGE 0028
 MEMBER NAME  PGMV
  |    **********************************************************        00992042
  |         DISPLAY '1100-PROCESS-MERCH-REC'                             00992199
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *****        00992369
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS ******        00992469
  |    ********* MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM *        00992569
             MOVE   LOW-VALUES          TO MERCH-KEY                     00992773
             START MERCH-KSDS     KEY IS > MERCH-KEY                     00992879
             IF WS-MERCH-KSDS-STATUS-CODE = '00'                         00992979
                DISPLAY 'START STATUS=' WS-MERCH-KSDS-STATUS-CODE        00993099
                CONTINUE                                                 00993179
             ELSE DISPLAY 'START ERROR  -  WS-MERCH-KSDS-STATUS-CODE='   00993299
                           WS-MERCH-KSDS-STATUS-CODE                     00993379
             END-IF                                                      00993479
             MOVE '00'     TO WS-MERCH-KSDS-STATUS-CODE                  00993599
             PERFORM UNTIL WS-MERCH-KSDS-STATUS-CODE NOT EQUAL '00'      00993699
  |    **********************************************************        00993799
  |    ** = GOES AFTER NOT AND BEFORE SPACE *********************        00993842
  |    **********************************************************        00993942
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00994042
  |    **********************************************************        00994142
  |    ***END WITH "END-IF" STATEMENT****************************        00994242
  |    **********************************************************        00994342
                 READ MERCH-KSDS NEXT INTO WS-MERCH-REC                  00994499
                                                                         00994599
 C5              IF WS-MERCH-KSDS-STATUS-CODE = '00'                     00994699
                   DISPLAY 'READ-WS-MERCH-KSDS-STATUS-CODE='             00994799
                            WS-MERCH-KSDS-STATUS-CODE                    00994899
                   DISPLAY 'WS-MERCH-REC-MERCH-ID='                      00997099
                            WS-MERCH-REC-MERCH-ID                        00998099
                   DISPLAY 'WS-MERCH-REC-MERCH-SEQ='                     00999099
                            WS-MERCH-REC-MERCH-SEQ                       00999199
                   DISPLAY 'WS-MERCH-REC-MERCH-ADDRESS='                 00999299
                            WS-MERCH-REC-MERCH-ADDRESS                   00999399
                   DISPLAY 'WS-MERCH-REC-MERCH-CITY='                    00999499
                            WS-MERCH-REC-MERCH-CITY                      00999599
                   DISPLAY 'WS-MERCH-REC-MERCH-STATE='                   00999699
                            WS-MERCH-REC-MERCH-STATE                     00999799
                   DISPLAY 'WS-MERCH-REC-MERCH-MSG='                     00999899
                            WS-MERCH-REC-MERCH-MSG                       00999999
                   PERFORM  1110-MOVE-WRITE-MERCH-REC                    01001299
 C5              ELSE DISPLAY 'READ-WS-MERCH-KSDS-STATUS-CODE='          01001599
                          WS-MERCH-KSDS-STATUS-CODE                      01001699
                 END-IF                                                  01001799
  >          END-PERFORM                                                 01001899
  -         .                                                            01008028
 C6     1110-MOVE-WRITE-MERCH-REC.                                       01008197
  V    **********************************************************        01008228
  |    ****PERFORMING MOVE AND WRIT STATED ABOVE****************         01008342
  |    **********************************************************        01008428
  |         DISPLAY  '1110-MOVE-WRITE-MERCH-REC'                         01008568
  |         DISPLAY  WS-MERCH-REC                                        01008668
  V    **********************************************************        01008742
  |    ****IF STATEMENTS FOR LINE COUNT**************************        01008842
  |    **********************************************************        01008942
            IF   WS-MERCH-PRT-LINE-COUNT > 11                            01009068
  |         THEN     PERFORM 1112-WRITE-PRT-MERCH-HDRS                   01010069
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020069
  |         ELSE                                                         01020155
1                                                                                                              PAGE 0029
 MEMBER NAME  PGMV
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020269
  |         END-IF                                                       01020355
  _         .                                                            01020441
       ****************************************************************  01020568
       ****************************************************************  01020797
       ****************************************************************  01020897
 C7     1111-MOVE-FLDS-WRITE-MERCH-DTL.                                  01020997
  V         DISPLAY '1111-MOVE-FLDS-WRITE-MERCH-DTL'                     01021097
  |         MOVE  WS-MERCH-REC-MERCH-ID TO WS-MERCH-PRT-ID               01021181
  |         MOVE  WS-MERCH-REC-MERCH-SEQ TO WS-MERCH-PRT-SEQ             01021271
  |         MOVE  WS-MERCH-REC-MERCH-ADDRESS TO WS-MERCH-PRT-ADDRESS     01021471
            MOVE  WS-MERCH-REC-MERCH-CITY TO WS-MERCH-PRT-CITY           01021581
            MOVE  WS-MERCH-REC-MERCH-STATE TO WS-MERCH-PRT-STATE         01021692
            MOVE  WS-MERCH-REC-MERCH-MSG TO WS-MERCH-PRT-MSG             01021792
  |         ADD      1                  TO WS-MERCH-PRT-LINE-COUNT       01021871
  |         WRITE MERCH-PRT-REC       FROM WS-MERCH-PRT-REC AFTER 2 LINE 01021971
  |         .                                                            01022055
  |     1112-WRITE-PRT-MERCH-HDRS.                                       01022169
  |         DISPLAY '1112-WRITE-PRT-MERCH-HDRS'                          01022269
  |         ADD          1       TO WS-MERCH-PRT-PAGE-COUNT              01022368
  |         MOVE   WS-MERCH-PRT-PAGE-COUNT                               01022482
            TO WS-MERCH-PRT-HDR1-PAGE-COUNT                              01022583
  |         MOVE         0       TO WS-MERCH-PRT-LINE-COUNT              01022668
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR1 AFTER PAGE       01022768
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR2 AFTER 2 LINES    01022868
  _         .                                                            01022955
1                                                                                                              PAGE 0030
 MEMBER NAME  COMPILEV
 //TRAIN05V JOB ,,CLASS=A,NOTIFY=&SYSUID,TIME=(0,2)               <CHG   00010005
 //   JCLLIB ORDER=(TRAIN00.CLASS.COBOL)                                 00020000
 //STEP1        EXEC IGYWCLG,LIBPRFX=CEE,PARM.COBOL='LIST,MAP'           00030000
 //**************************************************************        00040000
 //**************************************************************        00050000
 //**************************************************************        00080000
 //**************************************************************        00090000
 //COBOL.SYSIN  DD  DSN=TRAIN05.CLASS.SIUA.CAPSTONE(PGMV),DISP=SHR <CHG  00100011
 //LKED.SYSLMOD DD  DSNAME=TRAIN05.CLASS.LOADLIB(COBSKEL),DISP=SHR <CHG  00110009
 //GO.STEPLIB   DD  DSNAME=TRAIN05.CLASS.LOADLIB,DISP=SHR          <CHG  00120009
 //**************************************************************        00130000
 //**************************************************************        00140000
 //GO.SYSOUT    DD  SYSOUT=*,OUTLIM=1000                                 00150009
 //GO.MERCFILE  DD  DSN=TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH,DISP=SHR  00160011
 //PRNTMERC     DD SYSOUT=*,OUTLIM=1000                                  00170012
1                                                                                                              PAGE 0031
 MEMBER NAME  DCLMERCH
       ******************************************************************
       * DCLGEN TABLE(MERCHANT)                                         *
       *        LIBRARY(TRAIN05.CLASS.SIUA.CAPSTONE(DCLMERCH))          *
       *        ACTION(REPLACE)                                         *
       *        LANGUAGE(COBOL)                                         *
       *        NAMES(MERCH-)                                           *
       *        STRUCTURE(DCLMERCH)                                     *
       *        QUOTE                                                   *
       *        COLSUFFIX(YES)                                          *
       *        INDVAR(YES)                                             *
       * ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
       ******************************************************************
            EXEC SQL DECLARE MERCHANT TABLE
            ( ID                             DECIMAL(13, 0) NOT NULL,
              SEQ                            DECIMAL(2, 0) NOT NULL,
              ADDRESS                        CHAR(24) NOT NULL,
              CITY                           CHAR(21) NOT NULL,
              STATE                          CHAR(2) NOT NULL,
              MSG                            CHAR(5) NOT NULL
            ) END-EXEC.
       ******************************************************************
       * COBOL DECLARATION FOR TABLE MERCHANT                           *
       ******************************************************************
        01  DCLMERCH.
       *                       ID
            10 MERCH-ID             PIC S9(13)V USAGE COMP-3.
       *                       SEQ
            10 MERCH-SEQ            PIC S9(2)V USAGE COMP-3.
       *                       ADDRESS
            10 MERCH-ADDRESS        PIC X(24).
       *                       CITY
            10 MERCH-CITY           PIC X(21).
       *                       STATE
            10 MERCH-STATE          PIC X(2).
       *                       MSG
            10 MERCH-MSG            PIC X(5).
       ******************************************************************
       * INDICATOR VARIABLE STRUCTURE                                   *
       ******************************************************************
        01  IMERCHANT.
            10 INDSTRUC           PIC S9(4) USAGE COMP OCCURS 6 TIMES.
       ******************************************************************
       * THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 6       *
       ******************************************************************
1                         J E S 2  J O B  L O G  --  S Y S T E M  M V S 1  --  N O D E  N 1
0
 11.31.09 JOB06792 ---- FRIDAY,    02 FEB 2024 ----
 11.31.09 JOB06792  IRR010I  USERID TRAIN05  IS ASSIGNED TO THIS JOB.
 11.31.09 JOB06792  ICH70001I TRAIN05  LAST ACCESS AT 10:50:18 ON FRIDAY, FEBRUARY 2, 2024
 11.31.09 JOB06792  $HASP373 TRAIN05I STARTED - INIT 1    - CLASS A        - SYS MVS1
 11.31.09 JOB06792  IEF403I TRAIN05I - STARTED - TIME=11.31.09
 11.31.09 JOB06792  -                                      ----TIMINGS (MINUTES)-----                          -----PAGING COUNTS----
 11.31.09 JOB06792  -STEPNAME PROCSTEP    RC   EXCP   CONN       TCB       SRB  CLOCK          SERV  WORKLOAD  PAGE  SWAP   VIO SWAPS
 11.31.09 JOB06792  -PTPCH                00    239     13  0.000863  0.000035    0.0           351  PRDBAT       0     0     0     0
 11.31.09 JOB06792  IEF404I TRAIN05I - ENDED - TIME=11.31.09
 11.31.09 JOB06792  -TRAIN05I ENDED.  NAME-MAINTEC              TOTAL TCB CPU TIME= 0.000863 TOTAL ELAPSED TIME=   0.0 SUBSYS=JES2
 11.31.09 JOB06792  $HASP395 TRAIN05I ENDED - RC=0000
0------ JES2 JOB STATISTICS ------
-  02 FEB 2024 JOB EXECUTION DATE
-           17 CARDS READ
-        1,339 SYSOUT PRINT RECORDS
-            0 SYSOUT PUNCH RECORDS
-          112 SYSOUT SPOOL KBYTES
-         0.00 MINUTES EXECUTION TIME
         1 //TRAIN05I JOB 43312,'MAINTEC',                                         JOB06792
           //             CLASS=A,MSGCLASS=H,MSGLEVEL=(1,1),NOTIFY=&SYSUID         00020000
           //*******************************************************               00030000
           //*** I-P-O  I(NPUT)   P(ROCESS)   O(UTPUT)  ************               00040000
           //*** I - LIBRARY                          **************               00050000
           //*** P - PRINT ENTIRE LIBRARY FROM SYSUT1  TO  SYSUT2  *               00060000
           //***     PO=LIBRARY (MAX)MEMBS 200 1 RECORD FIELDS STMT*               00070000
           //*** O - SEND DATA TO "PRINT" / JES / ******************               00080000
           //*******************************************************               00090000
           IEFC653I SUBSTITUTION JCL - 43312,'MAINTEC',CLASS=A,MSGCLASS=H,MSGLEVEL=(1,1),NOTIFY=TRAIN05
         2 //PTPCH EXEC  PGM=IEBPTPCH                                              00100000
         3 //SYSPRINT DD  SYSOUT=*                                                 00110000
         4 //SYSIN    DD  *                                                        00120000
         5 //SYSUT2   DD  SYSOUT=*                                         OUTPUT  00150000
           //******  PRINT UP TO 200 MEMBERS OF A PDS                              00160000
         6 //SYSUT1  DD  DSN=TRAIN05.CLASS.SIUA.CAPSTONE,DISP=SHR          INPUT   00170002
 ICH70001I TRAIN05  LAST ACCESS AT 10:50:18 ON FRIDAY, FEBRUARY 2, 2024
 IEFA111I TRAIN05I IS USING THE FOLLOWING JOB RELATED SETTINGS:
          SWA=BELOW,TIOT SIZE=32K,DSENQSHR=DISALLOW,GDGBIAS=JOB
 IEF236I ALLOC. FOR TRAIN05I PTPCH
 IEF237I JES2 ALLOCATED TO SYSPRINT
 IEF237I JES2 ALLOCATED TO SYSIN
 IEF237I JES2 ALLOCATED TO SYSUT2
 IEF237I 306C ALLOCATED TO SYSUT1
 IEF142I TRAIN05I PTPCH - STEP WAS EXECUTED - COND CODE 0000
 IEF285I   TRAIN05.TRAIN05I.JOB06792.D0000102.?         SYSOUT
 IEF285I   TRAIN05.TRAIN05I.JOB06792.D0000101.?         SYSIN
 IEF285I   TRAIN05.TRAIN05I.JOB06792.D0000103.?         SYSOUT
 IEF285I   TRAIN05.CLASS.SIUA.CAPSTONE                  KEPT
 IEF285I   VOL SER NOS= USER10.
 IEF373I STEP/PTPCH   /START 2024033.1131
 IEF032I STEP/PTPCH   /STOP  2024033.1131
         CPU:     0 HR  00 MIN  00.05 SEC    SRB:     0 HR  00 MIN  00.00 SEC
         VIRT:    64K  SYS:   252K  EXT:        0K  SYS:    12784K
         ATB- REAL:                  1056K  SLOTS:                     0K
              VIRT- ALLOC:      13M SHRD:       0M
 IEF375I  JOB/TRAIN05I/START 2024033.1131
 IEF033I  JOB/TRAIN05I/STOP  2024033.1131
         CPU:     0 HR  00 MIN  00.05 SEC    SRB:     0 HR  00 MIN  00.00 SEC
1
-PRINT/PUNCH DATA SET UTILITY                                                                      PAGE 0001
   PRINT TYPORG=PO,MAXNAME=200,MAXFLDS=1                                 00130000
   RECORD FIELD=(80)                                                     00140000
  EOF ON SYSIN
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
1                                                                                                              PAGE 0001
 MEMBER NAME  MERCHANT
 CREATE TABLE MERCHANT                                                   00010001
   ( ID                 DECIMAL(13)     NOT NULL                         00020005
    , SEQ               DECIMAL(02)     NOT NULL                         00030003
    , ADDRESS           CHAR(24)        NOT NULL                         00040003
    , CITY              CHAR(21)        NOT NULL                         00050003
    , STATE             CHAR(02)        NOT NULL                         00060003
    , MSG               CHAR(05)        NOT NULL                         00070003
   )                                                                     00080001
 ;                                                                       00090001
 CREATE UNIQUE INDEX XMERCHANT1 ON MERCHANT(ID,SEQ)                      00100001
 ;                                                                       00110001
 INSERT INTO MERCHANT                                                    00120001
    (ID, SEQ, ADDRESS, CITY, STATE, MSG)                                 00130001
 VALUES (20056040000, 00, '1261 NO AZUSA AVE', 'COVINA', 'CA', 'NOTES' ) 00140005
 ;                                                                       00150005
 SELECT *                                                                00160005
 FROM MERCHANT                                                           00170006
 ;                                                                       00180005
1                                                                                                              PAGE 0002
 MEMBER NAME  MPRINT
 //TRAIN05V   JOB (123),'REGGIE CALHOUN',                                00010010
 //         MSGCLASS=X,CLASS=A,NOTIFY=&SYSUID,TIME=(0,3)                 00020007
 //********************************************************************  00030000
 //*** I-P-O  I(INPUT)   P(PROCESS)   O(OUTPUT)  **********************  00040000
 //*** I - DD * TO LIST RECORDS                                ********  00050000
 //*** P - PGM=IDCAMS REPRO TO COPY                            ********  00060010
 //*** O - DSN= PRINT CONTENTS INTO &&TEMP DATASET             ********  00070010
 //********************************************************************  00080000
 //STEP2 EXEC PGM=IDCAMS                                                 00090011
 //IDIN  DD   DSN=TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH,DISP=SHR        00100012
 //SYSPRINT DD SYSOUT=*,OUTLIM=1000                                      00120000
 //SYSIN DD *                                                            00130000
      PRINT   INFILE(IDIN) CHAR           -                              00160013
      FROMKEY('0020056040000') TOKEY('0020058040000')                    00161012
 /*                                                                      00170000
1                                                                                                              PAGE 0003
 MEMBER NAME  TESTD
 DELETE FROM MERCHANT                                                    00010000
 WHERE ID = 20056040000.                                                 00020000
1                                                                                                              PAGE 0004
 MEMBER NAME  TESTM
 SELECT *                                                                00010005
 FROM MERCHANT                                                           00020005
1                                                                                                              PAGE 0005
 MEMBER NAME  TRAIN05
        IDENTIFICATION DIVISION.                                         00010000
       *-----------------------                                          00020000
        PROGRAM-ID.    DB2SKEL.                                          00030000
                                                                         00040000
        ENVIRONMENT DIVISION.                                            00050000
       *--------------------                                             00060000
        CONFIGURATION SECTION.                                           00070000
        INPUT-OUTPUT SECTION.                                            00080000
        FILE-CONTROL.                                                    00090000
            SELECT CARDIN           ASSIGN TO CARDIN.                    00100000
                                                                         00110000
        DATA DIVISION.                                                   00120000
       *-------------                                                    00130000
        FILE SECTION.                                                    00140000
        FD      CARDIN                                                   00150000
                RECORD CONTAINS 80 CHARACTERS                            00160000
                RECORDING MODE IS F                                      00170000
                BLOCK CONTAINS 0 RECORDS.                                00180000
        01  CARDREC                 PIC X(80).                           00190000
                                                                         00200000
        WORKING-STORAGE SECTION.                                         00210000
        01  OUTPUT-BUFFER.                                               00220000
            05  OUTPUT-BUFFER-REC          PIC X(132).                   00230000
        01  IN-BUFFER.                                                   00240000
            05  TRAN-CODE                  PIC X(01).                    00250000
            05  TRAN-EMPLOYEE-NUMBER       PIC X(06).                    00260000
            05  TRAN-DEPARTMENT-NUMBER     PIC X(03).                    00270000
              05  TRAN-COL-NAME REDEFINES                                00280000
                   TRAN-DEPARTMENT-NUMBER  PIC X(03).                    00290000
            05  TRAN-LAST-NAME             PIC X(15).                    00300000
            05  TRAN-FIRST-NAME            PIC X(12).                    00310000
            05  TRAN-MIDDLE-INITIAL        PIC X(01).                    00320000
            05  TRAN-HIRE-DATE             PIC X(10).                    00330000
            05  TRAN-BIRTH-DATE            PIC X(10).                    00340000
            05  TRAN-PHONE-NUMBER          PIC X(04).                    00350000
            05  TRAN-SALARY                PIC 9(6)V99.                  00360000
            05  FILLER                     PIC X(10).                    00370000
                                                                         00380000
       *****************************************************             00390000
       * VARIABLES FOR ERROR-HANDLING                      *             00400000
       *****************************************************             00410000
        01  INPUT-SWITCH              PIC X(01)    VALUE 'Y'.            00420000
                88  NO-MORE-INPUT     VALUE 'N'.                         00430000
                88  MORE-INPUT        VALUE 'Y'.                         00440000
                                                                         00450000
        01  DB2-ERROR-SWITCH          PIC X(01)    VALUE 'N'.            00460000
                88  DB2-ERROR         VALUE 'Y'.                         00470000
                                                                         00480000
        01  ERROR-MESSAGE.                                               00490000
                05  ERROR-LEN   PIC S9(4)  COMP VALUE 1320.              00500000
                05  ERROR-TEXT  PIC X(132) OCCURS 10 TIMES               00510000
                                           INDEXED BY ERROR-INDEX.       00520000
        01  ERROR-TEXT-LEN      PIC S9(9)  COMP VALUE +132.              00530000
       *                                                                 00540000
        01  WS-DATE             PIC X(10).                               00550000
        01  WS-SQLCODE          PIC 99999-.                              00560000
       *                                                                 00570000
       **???????????????????????????????????????????????????             00580000
1                                                                                                              PAGE 0006
 MEMBER NAME  TRAIN05
       * PROVIDE THE SQL COMMUNICATION AREA                *             00590000
       **???????????????????????????????????????????????????             00600000
               EXEC  SQL  INCLUDE  SQLCA  END-EXEC.                      00610000
       **???????????????????????????????????????????????????             00620000
       * COPY A TABLE DECLARATION AND COBOL STRUCTURE      *             00630000
       * FOR YOUR TABLE                                    *             00640000
       * YOU SHOULD HAVE ALREADY PREPARED THIS USING       *             00650000
       * THE DCLGEN FUNCTION.                              *             00660000
       **???????????????????????????????????????????????????             00670000
       *                                                                 00680000
        PROCEDURE DIVISION.                                              00690000
       *------------------                                               00700000
            DISPLAY 'BEFORE 0000-MAIN-LINE'                              00710000
            DISPLAY ' '                                                  00720000
            DISPLAY '**********************************'                 00730000
            DISPLAY '*****  START OF INSTUCTOR TEST ***'                 00740000
            DISPLAY '**********************************'                 00750000
                                                                         00760000
       *********  TO MAKE SURE THAT WE CAN ACCESS DB2 *****************  00770000
            EXEC SQL                                                     00780000
               SET :WS-DATE = CURRENT DATE                               00790000
            END-EXEC                                                     00800000
            DISPLAY 'WS-DATE=' WS-DATE                                   00810000
                                                                         00820000
       *********  MAKE SURE THAT THE DSNTIAR ROUTINE WORKS CORRECTLY **  00830000
            MOVE +100 TO SQLCODE                                         00840000
            PERFORM Z000-DB2-ERROR                                       00850000
            DISPLAY ' '                                                  00860000
            DISPLAY '**********************************'                 00870000
            DISPLAY '***** E-N-D  OF INSTUCTOR TEST ***'                 00880000
            DISPLAY '**********************************'                 00890000
                                                                    .    00900000
                                                                         00910000
        0000-MAINLINE.                                                   00920000
            OPEN INPUT      CARDIN                                       00930000
                                                                         00940000
            PERFORM 1000-PROCESS-INPUT                                   00950000
               UNTIL INPUT-SWITCH = 'N'                                  00960000
                                                                         00970000
            CLOSE CARDIN                                                 00980000
                                                                         00990000
            GOBACK                                                       01000000
            .                                                            01010000
                                                                         01020000
        1000-PROCESS-INPUT.                                              01030000
            READ CARDIN RECORD INTO IN-BUFFER                            01040000
                AT END MOVE 'N' TO INPUT-SWITCH                          01050000
                NOT AT END CONTINUE                                      01060000
            END-READ                                                     01070000
                                                                         01080000
            DISPLAY ' '                                                  01090000
            DISPLAY '*************************************'              01100000
            DISPLAY '*   IN-BUFFER=', IN-BUFFER                          01110000
            DISPLAY '*************************************'              01120000
                                                                         01130000
            IF MORE-INPUT                                                01140000
                 EVALUATE TRAN-CODE                                      01150000
                     WHEN 'L' PERFORM 1000-TRAN-L                        01160000
1                                                                                                              PAGE 0007
 MEMBER NAME  TRAIN05
                     WHEN 'A' PERFORM 2000-TRAN-A                        01170000
                     WHEN 'E' PERFORM 3000-TRAN-E                        01180000
                     WHEN 'I' PERFORM 4000-TRAN-I                        01190000
                     WHEN 'D' PERFORM 5000-TRAN-D                        01200000
                     WHEN 'U' PERFORM 6000-TRAN-U                        01210000
                     WHEN 'Z' PERFORM 7000-TRAN-Z                        01220000
                     WHEN 'Y' PERFORM 8000-TRAN-Y                        01230000
                     WHEN 'X' PERFORM 9000-TRAN-X                        01240000
                     WHEN 'W' PERFORM A000-TRAN-W                        01250000
                     WHEN 'T' PERFORM B000-TRAN-T                        01260000
                     WHEN OTHER PERFORM  N000-OTHER-TRAN                 01270000
            END-EVALUATE                                                 01280000
            .                                                            01290000
                                                                         01300000
        1000-TRAN-L.                                                     01310000
            DISPLAY '   '                                                01320000
            DISPLAY '    --------------------------------'               01330000
            DISPLAY '    ---- PROCESS TRAN CODE L -------'               01340000
            DISPLAY '    --------------------------------'               01350000
                                                                         01360000
       ***************  PLACE YOUR SQL STATEMENT HERE  **************    01370000
                                                                         01380000
            DISPLAY 'SQLCODE='       SQLCODE                             01390000
            MOVE    SQLCODE       TO WS-SQLCODE                          01400000
            DISPLAY 'WS-SQLCODE='    WS-SQLCODE                          01410000
            DISPLAY 'SQLWARN0='      SQLWARN0                            01420000
                                                                         01430000
            EVALUATE SQLCODE                                             01440000
               WHEN 0  DISPLAY 'EMPLOYEE ' TRAN-EMPLOYEE-NUMBER ' FOUND' 01450000
               WHEN 100  DISPLAY 'EMPLOYEE NOT FOUND FOR '               01460000
                                  TRAN-EMPLOYEE-NUMBER                   01470000
               WHEN OTHER  PERFORM Z000-DB2-ERROR                        01480000
            END-EVALUATE                                                 01490000
            .                                                            01500000
                                                                         01510000
        2000-TRAN-A.                                                     01520000
            DISPLAY '   '                                                01530000
            DISPLAY '-------------------------------------'              01540000
            DISPLAY '2000 TRAN CODE A....'                               01550000
            .                                                            01560000
                                                                         01570000
        3000-TRAN-E.                                                     01580000
            DISPLAY '   '                                                01590000
            DISPLAY '-------------------------------------'              01600000
            DISPLAY '3000 TRAN CODE E....'                               01610000
            .                                                            01620000
                                                                         01630000
                                                                         01640000
        4000-TRAN-I.                                                     01650000
            DISPLAY '   '                                                01660000
            DISPLAY '-------------------------------------'              01670000
            DISPLAY '4000 TRAN CODE I....'                               01680000
            .                                                            01690000
                                                                         01700000
        5000-TRAN-D.                                                     01710000
            DISPLAY '   '                                                01720000
            DISPLAY '-------------------------------------'              01730000
            DISPLAY '5000 TRAN CODE D....'                               01740000
1                                                                                                              PAGE 0008
 MEMBER NAME  TRAIN05
            .                                                            01750000
                                                                         01760000
        6000-TRAN-U.                                                     01770000
            DISPLAY '   '                                                01780000
            DISPLAY '-------------------------------------'              01790000
            DISPLAY '6000 TRAN CODE U....'                               01800000
            .                                                            01810000
                                                                         01820000
        7000-TRAN-Z.                                                     01830000
            DISPLAY '   '                                                01840000
            DISPLAY '-------------------------------------'              01850000
            DISPLAY '7000 TRAN CODE Z....'                               01860000
            .                                                            01870000
                                                                         01880000
        8000-TRAN-Y.                                                     01890000
            DISPLAY '   '                                                01900000
            DISPLAY '-------------------------------------'              01910000
            DISPLAY '8000 TRAN CODE Y....'                               01920000
            .                                                            01930000
                                                                         01940000
        9000-TRAN-X.                                                     01950000
            DISPLAY '   '                                                01960000
            DISPLAY '-------------------------------------'              01970000
            DISPLAY '9000 TRAN CODE X....'                               01980000
            .                                                            01990000
                                                                         02000000
        A000-TRAN-W.                                                     02010000
            DISPLAY '   '                                                02020000
            DISPLAY '-------------------------------------'              02030000
            DISPLAY 'A000 TRAN CODE W....'                               02040000
            .                                                            02050000
                                                                         02060000
        B000-TRAN-T.                                                     02070000
            DISPLAY '   '                                                02080000
            DISPLAY '-------------------------------------'              02090000
            DISPLAY 'B000 TRAN CODE T....'                               02100000
            .                                                            02110000
                                                                         02120000
        N000-OTHER-TRAN.                                                 02130000
            DISPLAY 'N000 OTHER TRAN ....'                               02140000
            .                                                            02150000
                                                                         02160000
        Z000-DB2-ERROR.                                                  02170000
            DISPLAY 'Z000-DB2-ERROR....'                                 02180000
            CALL 'DSNTIAR' USING SQLCA ERROR-MESSAGE ERROR-TEXT-LEN      02190000
            PERFORM Z001-ERROR-PRINT                                     02200000
                VARYING ERROR-INDEX  FROM 1 BY 1                         02210000
                      UNTIL ERROR-INDEX GREATER THAN 10                  02220000
            .                                                            02230000
                                                                         02240000
        Z001-ERROR-PRINT.                                                02250000
            MOVE ERROR-TEXT(ERROR-INDEX) TO OUTPUT-BUFFER                02260000
            DISPLAY OUTPUT-BUFFER                                        02270000
            .                                                            02280000
                                                                         02290000
1                                                                                                              PAGE 0009
 MEMBER NAME  DB2DBIN2
 //TRAIN05B JOB ,,NOTIFY=&SYSUID,CLASS=A,MSGLEVEL=(1,1),MSGCLASS=H       00010002
 //JOBLIB   DD  DISP=SHR,DSN=DSNA10.SDSNEXIT                             00011001
 //         DD  DISP=SHR,DSN=DSNA10.SDSNLOAD                             00012001
 //BIND     EXEC PGM=IKJEFT01,DYNAMNBR=20                                00060000
 //DBRMLIB  DD DISP=SHR,                                                 00070000
 //         DSN='TRAIN05.CLASS.DB2.DBRMLIB'             --> DBRM LIBRARY 00080002
 //SYSTSPRT DD SYSOUT=*                                                  00090000
 //SYSPRINT DD SYSOUT=*                                                  00100000
 //SYSUMUMP DD SYSOUT=*                                                  00110000
 //SYSOUT   DD SYSOUT=*                                                  00120000
 //REPORT   DD SYSOUT=*                                                  00130000
 //SYSTSIN  DD *                                                         00140000
   DSN SYSTEM(DSN1)                                                      00150000
   BIND PLAN(TRAIN05) MEMBER(TRAIN05) ISOLATION(RR) ACTION(REP)          00160003
 //*                                                                     00170000
1                                                                                                              PAGE 0010
 MEMBER NAME  DB2COB2
 //TRAIN00C JOB ,,CLASS=A,NOTIFY=&SYSUID                                 00001006
 //***IN00D JOB ,,NOTIFY=&SYSUID,CLASS=A,MSGCLASS=H                      00010001
 //         JCLLIB ORDER=IBMUSER.COMPILER.JCLS                           00020001
 //EXEC1    EXEC DB2JCL,                                                 00022001
 //         SRCLIB='TRAIN00.CLASS.DB2',          -->  SOURCE LIB         00023004
 //         DBRMLIB='TRAIN05.CLASS.DB2.DBRMLIB', -->DBRM LIBRARY         00024007
 //         MEM=TRAIN00,                         -->  MEMBER NAME        00025005
 //         DCLLIB='TRAIN05.CLASS.DB2',          -->  DCLGEN LIBRARY     00026007
 //         COPYLIB='TRAIN05.CLASS.DB2',         -->  COPY LIBRARY       00027007
 //         LOADLIB='TRAIN05.CLASS.DB2.LOADLIB'  -->  LOAD LIBRARY       00028007
1                                                                                                              PAGE 0011
 MEMBER NAME  DB2LOADU
 //TRAIN05U JOB ,,CLASS=A,NOTIFY=&SYSUID                                 00001002
 //LOAD     EXEC  DSNUPROC,PARM='DSN1'                                   00002000
 //SYSIN    DD    *                                                      00003000
   LOAD DATA  INDDN SYSREC  RESUME YES                                   00003101
    INTO TABLE DEPT                                                      00003201
    ( DEPTNO   POSITION (001) CHAR(3) ,                                  00003300
      DEPTNAME POSITION (004) CHAR(36) ,                                 00003400
      MGRNO    POSITION (040) CHAR(6),                                   00003500
      ADMRDEPT POSITION (046) CHAR(3) ,                                  00003600
      LOCATION POSITION (049) CHAR(16) )                                 00003700
 //SYSREC   DD    *                                                      00004000
 A22DEPARTMENT A22                      000222A00                        00006000
 B33DEPARTMENT B33                      000444B11                        00007000
1                                                                                                              PAGE 0012
 MEMBER NAME  TESTI
 INSERT INTO MERCHANT                                                    00010000
    (ID, SEQ, ADDRESS, CITY, STATE, MSG)                                 00020000
 VALUES (20056040000, 00, '1261 NO AZUSA AVE', 'COVINA', 'CA', 'NOTES' ) 00030000
1                                                                                                              PAGE 0013
 MEMBER NAME  INDEX
 CAPSTONE INDEX
 -MERCHANT (SPUFI)
     CREATE MERCHANT TABLE WITH IN COLUMS SPECIFIED IN INSTRUCTIONS
     C1- ADDED FIRST LINE OF DATA AS A TEST
 ************************************************************************
 -KSDSM (JCL)
     PROGRAM USED: IDCAMS
     CREATE KSDS CLUSTER FOR MERCHANT DATA FROM CAPSTONE.DATA
     NOTES: USED MERCHANT ID FOR KEY
 ************************************************************************
 -KDSDP (JCL)
     PROGRAM USED: IDCAMS
     PRINTED FIRST 20 LINES OF DATA FROM CAPSTONE.KSDS.MERCHANT IN
     CHAR FORM
 ************************************************************************
 -PGMV  (COB/VSAM)
     C-1 MERCFILE INSERT AND FD
     C-2 MERCFILE WORKING STORAGE
     C-3 ADD MERCH PRINT FILE AND WS
     C-4 OPEN MERCH-KSDS
     C-5 START AT TOP OF MERCH-KSDS AND READ
         INTO MERCH REC
     C-6 MOVE FIELDS AND HEADERS
     C-7 MOVE ALL MERCH REC IN TO PRT REC
1                                                                                                              PAGE 0014
 MEMBER NAME  KSDSM
 //TRAIN05F   JOB (123),'REGGIE CALHOUN',                                00010009
 //         MSGCLASS=X,CLASS=A,NOTIFY=&SYSUID,TIME=(0,3)                 00020007
 //********************************************************************  00030000
 //*** I-P-O  I(INPUT)   P(PROCESS)   O(OUTPUT)  **********************  00040000
 //*** I - DD * TO LIST RECORDS                                ********  00050000
 //*** P - PGM=IDCAMS REPRO TO COPY                                      00060000
 //*** O - DSN= PRINT CONTENTS INTO &&TEMP DATASET                    *  00070000
 //********************************************************************  00080000
 //REPRO EXEC PGM=IDCAMS                                                 00090000
 //IDIN  DD   DSN=TRAIN05.CLASS.SIUA.CAPSTONE.DATA,DISP=SHR              00100010
 //SYSPRINT DD SYSOUT=*,OUTLIM=1000                                      00120000
 //SYSIN DD *                                                            00130000
      DELETE  (TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH)                   00131011
      DEFINE  CLUSTER                                 -                  00132003
              (                                       -                  00133003
               NAME(TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH) -            00134011
               RECORDS (100 50 )                      -                  00135003
               VOLUME(USER05)                         -                  00136009
               FSPC(20 10 )                           -                  00137003
               KEYS(13 0)                             -                  00138011
               RECORDSIZE(80 80)                      -                  00139003
                                             )                           00139103
      REPRO   INFILE(IDIN) ODS(TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH)   00140011
      PRINT   IDS(TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH) CHAR           00160011
      PRINT   IDS(TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH) HEX            00161011
      PRINT   IDS(TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH) DUMP           00162011
      LISTCAT ENTRY (TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH) ALL         00163011
 /*                                                                      00170000
 //SYSDUMP DD SYSOUT=*                                                   00180000
1                                                                                                              PAGE 0015
 MEMBER NAME  BACKUP01
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       VSAMPGM.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          01-18      ORIGINAL CODE                       00080000
 C1    *    C1            01-18      MERCFILE INSERT AND FD              00090000
 C2    *    C2            01-18      MERCFILE WORKING STORAGE            00100000
 C3    *    C3            01-19      ADD MERCH PRINT FILE AND WS         00110000
 C4    *    C4            01-19      OPEN MERCH-KSDS                     00110100
 C5    *    C5            01-19      START AT TOP OF MERCH-KSDS AND READ 00110200
       *                             INTO MERCH REC                      00110300
 C6    *    C6            01-20      MOVE FIELDS AND HEADERS             00110400
 C7    *    C7            01-21      MOVE ALL MERCH REC IN TO PRT REC    00110500
       ***************************************************************** 00111000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-MERCH-KSDS                                       00191000
       ***     OPEN MERCH-KSDS                                           00192000
       ***         1100-PROCESS-MERCH-REC                                00193000
       ***     CLOSE MERCH-KSDS                                          00194000
       *** 1110-PROCESS-MERCH-REC-DETAILS                                00195000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
       *--------------------                                             00220000
        CONFIGURATION SECTION.                                           00230000
        INPUT-OUTPUT SECTION.                                            00231000
        FILE-CONTROL.                                                    00232000
       *----- ADD SELECT FOR MERCH-KSDS 5 LINES                          00235000
 C1         SELECT MERCH-KSDS ASSIGN TO MERCFILE                         00236000
 C1                ORGANIZATION      IS INDEXED                          00237000
 C1                ACCESS MODE       IS DYNAMIC                          00238000
 C1                RECORD KEY        IS MERCH-KEY                        00239000
 C1                FILE STATUS       IS WS-MERCH-KSDS-STATUS-CODE.       00239100
 C1         SELECT MERCH-PRT-FILE ASSIGN TO PRNTMERC.                    00239200
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
 C1     FD  MERCH-KSDS                                                   00391000
 C1         RECORD CONTAINS 80 CHARACTERS.                               00392000
 C1     01  MERCH-REC.                                                   00393000
 C1         05  MERCH-KEY                      PIC X(13).                00394000
 C1         05                                 PIC X(67).                00395000
 C1     FD  MERCH-PRT-FILE                                               00396000
 C1         RECORD CONTAINS 133 CHARACTERS                               00397000
 C1         BLOCK  CONTAINS  0 RECORDS                                   00398000
 C1         RECORDING  MODE IS F.                                        00399000
 C1     01  MERCH-PRT-REC      PIC X(133).                               00399100
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
1                                                                                                              PAGE 0016
 MEMBER NAME  BACKUP01
       ********* WS - OUR DATA NAMES *******************                 00420000
 C2     01  WS-MERCH-REC.                                                00430000
 C2       05  WS-MERCH-REC-MERCH-ID          PIC X(13).                  00440000
 C2       05  WS-MERCH-REC-MERCH-SEQ         PIC X(02).                  00450000
 C2       05  WS-MERCH-REC-MERCH-ADDRESS     PIC X(24).                  00451000
 C2       05  WS-MERCH-REC-MERCH-CITY        PIC X(21).                  00452000
 C2       05  WS-MERCH-REC-MERCH-STATE       PIC X(02).                  00453000
 C2       05  WS-MERCH-REC-MERCH-MSG         PIC X(05).                  00454000
 C2       05                                 PIC X(13) VALUE SPACES.     00454100
                                                                         00455000
        01  WS-MERCH-PRT-LINE-COUNT  PIC 9(2)     VALUE 0.               00455100
        01  WS-MERCH-PRT-PAGE-COUNT  PIC 9(5)     VALUE 0.               00455200
        01  WS-MERCH-PRT-HDR1.                                           00455300
          05  FILLER               PIC X(20)     VALUE SPACES.           00455400
          05                       PIC X(17) VALUE '-MERCHANT RECORD-'.  00455500
          05                       PIC X(20)     VALUE SPACES.           00455600
          05                       PIC X(10)     VALUE 'PAGE NO:'.       00455700
          05  WS-MERCH-PRT-HDR1-PAGE-COUNT PIC ZZZZ9.                    00455800
          05                        PIC X(21)     VALUE SPACES.          00455900
        01  WS-MERCH-PRT-HDR2.                                           00456000
          05                         PIC X(05)       VALUE SPACES.       00456100
          05                         PIC X(13)  VALUE 'MERCH. ID'.       00456200
          05                         PIC X(05)       VALUE SPACES.       00456300
          05                         PIC X(10) VALUE 'MERCH. SEQ'.       00456400
          05                         PIC X(05)       VALUE SPACES.       00456500
          05                         PIC X(24)    VALUE 'ADDRESS'.       00456600
          05                         PIC X(05)       VALUE SPACES.       00456800
          05                         PIC X(21)       VALUE 'CITY'.       00456900
          05                         PIC X(05)       VALUE SPACES.       00457000
          05                         PIC X(05)       VALUE 'STATE'.      00457100
          05                         PIC X(05)       VALUE SPACES.       00457200
          05                         PIC X(05)       VALUE 'MSG'.        00457300
          05                         PIC X(28)       VALUE SPACES.       00457400
        01  WS-MERCH-PRT-REC.                                            00457500
          05                         PIC X(05)       VALUE SPACES.       00457600
          05  WS-MERCH-PRT-ID        PIC X(13).                          00457700
          05                         PIC X(05)       VALUE SPACES.       00457800
          05  WS-MERCH-PRT-SEQ       PIC X(10).                          00457900
          05                         PIC X(05)   VALUE SPACES.           00458000
          05  WS-MERCH-PRT-ADDRESS   PIC X(24).                          00458100
          05                         PIC X(05)   VALUE SPACES.           00458200
          05  WS-MERCH-PRT-CITY      PIC X(21).                          00458300
          05                         PIC X(05)   VALUE SPACES.           00458400
          05  WS-MERCH-PRT-STATE     PIC X(02).                          00458500
          05                         PIC X(05)   VALUE SPACES.           00458600
          05  WS-MERCH-PRT-MSG       PIC X(05).                          00458700
          05                         PIC X(28)   VALUE SPACES.           00458800
                                                                         00458900
        01 WS-MERCH-KSDS-STATUS-CODE          PIC X(02).                 00459000
        01 WS-INPUT-SWITCH                    PIC X(01) VALUE 'Y'.       00459100
               88 NO-MORE-INPUT       VALUE 'N'.                         00459200
               88 MORE-INPUT          VALUE 'Y'.                         00459300
        LINKAGE SECTION.                                                 00460000
        PROCEDURE DIVISION.                                              00470000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
1                                                                                                              PAGE 0017
 MEMBER NAME  BACKUP01
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-MERCH-KSDS                              00540000
                THRU 1000-EXIT                                           00550000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00600000
 C4    **********************************************************        00972900
  V    *********************************************************         00973000
  |    **********************************************************        00973100
  |     1000-PROCESS-MERCH-KSDS.                                         00973200
  |    **********************************************************        00973300
  |    ***  OPEN THE MERCH FILE TO ALLOW FOR PROCESSING   **             00973400
  |    ***  PROCESS THE MERCH FILE IN THE 1000- PARAGRAPH **             00974000
  |    ***  CLOSE THE MERCH FILE WHEN THE PROCESSING IN        **        00975000
  |    ***      PARAGRAPH 1100- IS FINISHED                    **        00976000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00977000
  |    **********************************************************        00978000
  |         DISPLAY '1000-PROCESS-MERCH-KSDS'                            00979000
  |                                                                      00979100
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00979200
 C6         MOVE 0 TO WS-MERCH-PRT-PAGE-COUNT                            00979300
 C6         MOVE 10 TO WS-MERCH-PRT-LINE-COUNT                           00979400
  |         OPEN I-O MERCH-KSDS                                          00979500
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00979600
  |            CONTINUE                                                  00979700
  |         ELSE DISPLAY 'OPEN-WS-MERCH-KSDS-STATUS-CODE='               00979800
  |                       WS-MERCH-KSDS-STATUS-CODE                      00979900
  |          END-IF                                                      00980000
  |         DISPLAY '**** S-T-A-R-T OF MERCH FILE****'                   00980500
  |         DISPLAY ' '                                                  00980600
  |    ********* USE OPEN OUTPUT TO READ A PRINT *********************** 00980700
  |         OPEN OUTPUT MERCH-PRT-FILE                                   00980800
  |    ********* MOVE SPACES    RESET INPUT-SWITCH      INDICATOR ****** 00981700
  |         MOVE SPACES  TO  WS-INPUT-SWITCH                             00981800
  |                                                                      00981900
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00982000
  |         PERFORM 1100-PROCESS-MERCH-REC                               00982100
  |                  UNTIL WS-INPUT-SWITCH = 'N'                         00982200
  |                                                                      00982300
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00983000
  |         CLOSE MERCH-KSDS                                             00984000
  |         DISPLAY ' '                                                  00985000
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00985100
  |            CONTINUE                                                  00985200
  |         ELSE DISPLAY 'CLOSE-WS-MERCH-KSDS-STATUS-CODE='              00985300
  |                       WS-MERCH-KSDS-STATUS-CODE                      00985400
  |         DISPLAY '****  E-N-D OF MERCH FILE ****'                     00986000
  |         WRITE MERCH-PRT-REC                                          00986100
  |         CLOSE MERCH-PRT-FILE                                         00986300
  _         .                                                            00988000
       ***********************************************************       00991300
       ***********************************************************       00991400
       ***********************************************************       00991500
 C5                                                                      00991600
  V     1100-PROCESS-MERCH-REC.                                          00991700
  |    **********************************************************        00991800
1                                                                                                              PAGE 0018
 MEMBER NAME  BACKUP01
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  *********        00991900
  |    **********************************************************        00992000
  |    *    DISPLAY '1100-PROCESS-MERCH-REC' ********************        00992100
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *****        00992300
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS ******        00992400
  |    ********* MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM *        00992500
             MOVE   LOW-VALUES          TO MERCH-KEY                     00992700
             START MERCH-KSDS     KEY IS > MERCH-KEY                     00992800
             IF WS-MERCH-KSDS-STATUS-CODE = '00'                         00992900
                CONTINUE                                                 00993000
             ELSE DISPLAY 'START ERROR   -   WS-MERCH-KSDS-STATUS-CODE'  00993100
                           WS-MERCH-KSDS-STATUS-CODE                     00993200
             END-IF                                                      00993300
  |    **********************************************************        00993500
  |    ** = GOES AFTER NOT AND BEFORE SPACE *********************        00993600
  |    **********************************************************        00993700
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00993800
  |    **********************************************************        00993900
  |    ***END WITH "END-IF" STATEMENT****************************        00994000
  |    **********************************************************        00994100
            READ MERCH-KSDS NEXT INTO WS-MERCH-REC                       00994300
                 PERFORM UNTIL WS-INPUT-SWITCH = 'N'                     00994400
 C5              IF WS-MERCH-KSDS-STATUS-CODE = '00'                     00994500
 C5                 CONTINUE                                             00994600
 C5              ELSE DISPLAY 'READ-WS-MERCH-KSDS-STATUS-CODE='          00994700
 C5                         WS-MERCH-KSDS-STATUS-CODE                    00994800
                    PERFORM 1000-EXIT                                    00994900
 C5              END-IF                                                  00995000
  |           IF WS-MERCH-REC-MERCH-ID NOT = SPACE                       00996000
  |                 DISPLAY 'WS-MERCH-REC-MERCH-ID='                     00997000
  |                            WS-MERCH-REC-MERCH-ID                     00998000
  |                 DISPLAY 'WS-MERCH-REC-MERCH-SEQ='                    00999000
  |                            WS-MERCH-REC-MERCH-SEQ                    00999100
  |                 DISPLAY 'WS-MERCH-REC-MERCH-ADDRESS='                00999200
  |                            WS-MERCH-REC-MERCH-ADDRESS                00999300
  |                 DISPLAY 'WS-MERCH-REC-MERCH-CITY='                   00999400
  |                            WS-MERCH-REC-MERCH-CITY                   00999500
  |                 DISPLAY 'WS-MERCH-REC-MERCH-STATE='                  00999600
  |                            WS-MERCH-REC-MERCH-STATE                  00999700
  |                 DISPLAY 'WS-MERCH-REC-MERCH-MSG='                    00999800
  |                            WS-MERCH-REC-MERCH-MSG                    00999900
  |                 PERFORM 1110-MOVE-WRITE-MERCH-REC                    01001200
  |               ELSE                                                   01001300
  |                 DISPLAY 'BAD RECORD'                                 01001400
  >           END-IF                                                     01001500
  -         .                                                            01008000
 C6     1110-MOVE-WRITE-MERCH-REC.                                       01008100
  V    **********************************************************        01008200
  |    ****PERFORMING MOVE AND WRIT STATED ABOVE****************         01008300
  |    **********************************************************        01008400
  |         DISPLAY  '1110-MOVE-WRITE-MERCH-REC'                         01008500
  |         DISPLAY  WS-MERCH-REC                                        01008600
  V    **********************************************************        01008700
  |    ****IF STATEMENTS FOR LINE COUNT**************************        01008800
  |    **********************************************************        01008900
            IF   WS-MERCH-PRT-LINE-COUNT > 11                            01009000
  |         THEN     PERFORM 1112-WRITE-PRT-MERCH-HDRS                   01010000
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020000
1                                                                                                              PAGE 0019
 MEMBER NAME  BACKUP01
  |         ELSE                                                         01020100
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020200
  |         END-IF                                                       01020300
  _         .                                                            01020400
       ****************************************************************  01020500
       ****************************************************************  01020700
       ****************************************************************  01020800
 C7     1111-MOVE-FLDS-WRITE-MERCH-DTL.                                  01020900
  V         DISPLAY '1111-MOVE-FLDS-WRITE-MERCH-DTL'                     01021000
  |         MOVE  WS-MERCH-REC-MERCH-ID TO WS-MERCH-PRT-ID               01021100
  |         MOVE  WS-MERCH-REC-MERCH-SEQ TO WS-MERCH-PRT-SEQ             01021200
  |         MOVE  WS-MERCH-REC-MERCH-ADDRESS TO WS-MERCH-PRT-ADDRESS     01021400
            MOVE  WS-MERCH-REC-MERCH-CITY TO WS-MERCH-PRT-CITY           01021500
            MOVE  WS-MERCH-REC-MERCH-STATE TO WS-MERCH-PRT-STATE         01021600
            MOVE  WS-MERCH-REC-MERCH-MSG TO WS-MERCH-PRT-MSG             01021700
  |         ADD      1                  TO WS-MERCH-PRT-LINE-COUNT       01021800
  |         WRITE MERCH-PRT-REC       FROM WS-MERCH-PRT-REC AFTER 2 LINE 01021900
  |         .                                                            01022000
  |     1112-WRITE-PRT-MERCH-HDRS.                                       01022100
  |         DISPLAY '1112-WRITE-PRT-MERCH-HDRS'                          01022200
  |         ADD          1       TO WS-MERCH-PRT-PAGE-COUNT              01022300
  |         MOVE   WS-MERCH-PRT-PAGE-COUNT                               01022400
            TO WS-MERCH-PRT-HDR1-PAGE-COUNT                              01022500
  |         MOVE         0       TO WS-MERCH-PRT-LINE-COUNT              01022600
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR1 AFTER PAGE       01022700
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR2 AFTER 2 LINES    01022800
  _         .                                                            01022900
        1000-EXIT.                                                       01023000
            EXIT                                                         01024000
            .                                                            01025000
1                                                                                                              PAGE 0020
 MEMBER NAME  BACKUPO2
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       VSAMPGM.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          01-18      ORIGINAL CODE                       00080000
 C1    *    C1            01-18      MERCFILE INSERT AND FD              00090000
 C2    *    C2            01-18      MERCFILE WORKING STORAGE            00100000
 C3    *    C3            01-19      ADD MERCH PRINT FILE AND WS         00110000
 C4    *    C4            01-19      OPEN MERCH-KSDS                     00110100
 C5    *    C5            01-19      START AT TOP OF MERCH-KSDS AND READ 00110200
       *                             INTO MERCH REC                      00110300
 C6    *    C6            01-20      MOVE FIELDS AND HEADERS             00110400
 C7    *    C7            01-21      MOVE ALL MERCH REC IN TO PRT REC    00110500
       ***************************************************************** 00111000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-MERCH-KSDS                                       00191000
       ***     OPEN MERCH-KSDS                                           00192000
       ***         1100-PROCESS-MERCH-REC                                00193000
       ***     CLOSE MERCH-KSDS                                          00194000
       *** 1110-PROCESS-MERCH-REC-DETAILS                                00195000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
       *--------------------                                             00220000
        CONFIGURATION SECTION.                                           00230000
        INPUT-OUTPUT SECTION.                                            00231000
        FILE-CONTROL.                                                    00232000
       *----- ADD SELECT FOR MERCH-KSDS 5 LINES                          00235000
 C1         SELECT MERCH-KSDS ASSIGN TO MERCFILE                         00236000
 C1                ORGANIZATION      IS INDEXED                          00237000
 C1                ACCESS MODE       IS DYNAMIC                          00238000
 C1                RECORD KEY        IS MERCH-KEY                        00239000
 C1                FILE STATUS       IS WS-MERCH-KSDS-STATUS-CODE.       00239100
 C1         SELECT MERCH-PRT-FILE ASSIGN TO PRNTMERC.                    00239200
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
 C1     FD  MERCH-KSDS                                                   00391000
 C1         RECORD CONTAINS 80 CHARACTERS.                               00392000
 C1     01  MERCH-REC.                                                   00393000
 C1         05  MERCH-KEY                      PIC X(13).                00394000
 C1         05                                 PIC X(67).                00395000
 C1     FD  MERCH-PRT-FILE                                               00396000
 C1         RECORD CONTAINS 133 CHARACTERS                               00397000
 C1         BLOCK  CONTAINS  0 RECORDS                                   00398000
 C1         RECORDING  MODE IS F.                                        00399000
 C1     01  MERCH-PRT-REC      PIC X(133).                               00399100
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
1                                                                                                              PAGE 0021
 MEMBER NAME  BACKUPO2
       ********* WS - OUR DATA NAMES *******************                 00420000
 C2     01  WS-MERCH-REC.                                                00430000
 C2       05  WS-MERCH-REC-MERCH-ID          PIC X(13).                  00440000
 C2       05  WS-MERCH-REC-MERCH-SEQ         PIC X(02).                  00450000
 C2       05  WS-MERCH-REC-MERCH-ADDRESS     PIC X(24).                  00451000
 C2       05  WS-MERCH-REC-MERCH-CITY        PIC X(21).                  00452000
 C2       05  WS-MERCH-REC-MERCH-STATE       PIC X(02).                  00453000
 C2       05  WS-MERCH-REC-MERCH-MSG         PIC X(05).                  00454000
 C2       05                                 PIC X(13) VALUE SPACES.     00454100
                                                                         00455000
        01  WS-MERCH-PRT-LINE-COUNT  PIC 9(2)     VALUE 0.               00455100
        01  WS-MERCH-PRT-PAGE-COUNT  PIC 9(5)     VALUE 0.               00455200
        01  WS-MERCH-PRT-HDR1.                                           00455300
          05  FILLER               PIC X(20)     VALUE SPACES.           00455400
          05                       PIC X(17) VALUE '-MERCHANT RECORD-'.  00455500
          05                       PIC X(20)     VALUE SPACES.           00455600
          05                       PIC X(10)     VALUE 'PAGE NO:'.       00455700
          05  WS-MERCH-PRT-HDR1-PAGE-COUNT PIC ZZZZ9.                    00455800
          05                        PIC X(21)     VALUE SPACES.          00455900
        01  WS-MERCH-PRT-HDR2.                                           00456000
          05                         PIC X(05)       VALUE SPACES.       00456100
          05                         PIC X(13)  VALUE 'MERCH. ID'.       00456200
          05                         PIC X(05)       VALUE SPACES.       00456300
          05                         PIC X(10) VALUE 'MERCH. SEQ'.       00456400
          05                         PIC X(05)       VALUE SPACES.       00456500
          05                         PIC X(24)    VALUE 'ADDRESS'.       00456600
          05                         PIC X(05)       VALUE SPACES.       00456800
          05                         PIC X(21)       VALUE 'CITY'.       00456900
          05                         PIC X(05)       VALUE SPACES.       00457000
          05                         PIC X(05)       VALUE 'STATE'.      00457100
          05                         PIC X(05)       VALUE SPACES.       00457200
          05                         PIC X(05)       VALUE 'MSG'.        00457300
          05                         PIC X(28)       VALUE SPACES.       00457400
        01  WS-MERCH-PRT-REC.                                            00457500
          05                         PIC X(05)       VALUE SPACES.       00457600
          05  WS-MERCH-PRT-ID        PIC X(13).                          00457700
          05                         PIC X(05)       VALUE SPACES.       00457800
          05  WS-MERCH-PRT-SEQ       PIC X(10).                          00457900
          05                         PIC X(05)   VALUE SPACES.           00458000
          05  WS-MERCH-PRT-ADDRESS   PIC X(24).                          00458100
          05                         PIC X(05)   VALUE SPACES.           00458200
          05  WS-MERCH-PRT-CITY      PIC X(21).                          00458300
          05                         PIC X(05)   VALUE SPACES.           00458400
          05  WS-MERCH-PRT-STATE     PIC X(02).                          00458500
          05                         PIC X(05)   VALUE SPACES.           00458600
          05  WS-MERCH-PRT-MSG       PIC X(05).                          00458700
          05                         PIC X(28)   VALUE SPACES.           00458800
                                                                         00458900
        01 WS-MERCH-KSDS-STATUS-CODE          PIC X(02).                 00459000
        01 WS-INPUT-SWITCH                    PIC X(01) VALUE 'Y'.       00459100
               88 NO-MORE-INPUT       VALUE 'N'.                         00459200
               88 MORE-INPUT          VALUE 'Y'.                         00459300
        LINKAGE SECTION.                                                 00460000
        PROCEDURE DIVISION.                                              00470000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
1                                                                                                              PAGE 0022
 MEMBER NAME  BACKUPO2
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-MERCH-KSDS                              00540000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00600000
 C4    **********************************************************        00972900
  V    *********************************************************         00973000
  |    **********************************************************        00973100
  |     1000-PROCESS-MERCH-KSDS.                                         00973200
  |    **********************************************************        00973300
  |    ***  OPEN THE MERCH FILE TO ALLOW FOR PROCESSING   **             00973400
  |    ***  PROCESS THE MERCH FILE IN THE 1000- PARAGRAPH **             00974000
  |    ***  CLOSE THE MERCH FILE WHEN THE PROCESSING IN        **        00975000
  |    ***      PARAGRAPH 1100- IS FINISHED                    **        00976000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00977000
  |    **********************************************************        00978000
  |         DISPLAY '1000-PROCESS-MERCH-KSDS'                            00979000
  |                                                                      00979100
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00979200
 C6         MOVE 0 TO  WS-MERCH-PRT-PAGE-COUNT                           00979300
 C6         MOVE 10 TO WS-MERCH-PRT-LINE-COUNT                           00979400
  |         OPEN I-O   MERCH-KSDS                                        00979500
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00979600
  |            CONTINUE                                                  00979700
  |         ELSE DISPLAY 'OPEN-WS-MERCH-KSDS-STATUS-CODE='               00979800
  |                       WS-MERCH-KSDS-STATUS-CODE                      00979900
  |          END-IF                                                      00980000
  |         DISPLAY '**** S-T-A-R-T OF MERCH FILE****'                   00980500
  |         DISPLAY ' '                                                  00980600
  |    ********* USE OPEN OUTPUT TO READ A PRINT *********************** 00980700
  |         OPEN OUTPUT MERCH-PRT-FILE                                   00980800
  |    ********* MOVE SPACES    RESET INPUT-SWITCH      INDICATOR ****** 00981700
  |         MOVE SPACES  TO  WS-INPUT-SWITCH                             00981800
  |                                                                      00981900
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00982000
  |         PERFORM 1100-PROCESS-MERCH-REC                               00982100
  |                  UNTIL WS-INPUT-SWITCH = 'N'                         00982200
  |                                                                      00982300
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00983000
  |         CLOSE MERCH-KSDS                                             00984000
  |         DISPLAY ' '                                                  00985000
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00985100
  |            CONTINUE                                                  00985200
  |         ELSE DISPLAY 'CLOSE-WS-MERCH-KSDS-STATUS-CODE='              00985300
  |                       WS-MERCH-KSDS-STATUS-CODE                      00985400
  |         DISPLAY '****  E-N-D OF MERCH FILE ****'                     00986000
  |         WRITE MERCH-PRT-REC                                          00986100
  |         CLOSE MERCH-PRT-FILE                                         00986300
  _         .                                                            00988000
       ***********************************************************       00991300
       ***********************************************************       00991400
       ***********************************************************       00991500
 C5                                                                      00991600
  V     1100-PROCESS-MERCH-REC.                                          00991700
  |    **********************************************************        00991800
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  *********        00991900
1                                                                                                              PAGE 0023
 MEMBER NAME  BACKUPO2
  |    **********************************************************        00992000
  |         DISPLAY '1100-PROCESS-MERCH-REC'                             00992100
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *****        00992300
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS ******        00992400
  |    ********* MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM *        00992500
             MOVE   LOW-VALUES          TO MERCH-KEY                     00992700
             START MERCH-KSDS     KEY IS > MERCH-KEY                     00992800
             IF WS-MERCH-KSDS-STATUS-CODE = '00'                         00992900
                CONTINUE                                                 00993000
             ELSE DISPLAY 'START ERROR   -   WS-MERCH-KSDS-STATUS-CODE'  00993100
                           WS-MERCH-KSDS-STATUS-CODE                     00993200
             END-IF                                                      00993300
             MOVE '00'     TO WS-MERCH-KSDS-STATUS-CODE                  00993400
             PERFORM UNTIL WS-MERCH-KSDS-STATUS-CODE NOT EQUAL '00'      00993500
  |    **********************************************************        00993600
  |    ** = GOES AFTER NOT AND BEFORE SPACE *********************        00993700
  |    **********************************************************        00993800
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00993900
  |    **********************************************************        00994000
  |    ***END WITH "END-IF" STATEMENT****************************        00994100
  |    **********************************************************        00994200
                 READ MERCH-KSDS NEXT INTO WS-MERCH-REC                  00994300
 C5              IF WS-MERCH-KSDS-STATUS-CODE = '00'                     00994500
                   DISPLAY 'WS-MERCH-REC-MERCH-ID='                      00997000
                            WS-MERCH-REC-MERCH-ID                        00998000
                   DISPLAY 'WS-MERCH-REC-MERCH-SEQ='                     00999000
                            WS-MERCH-REC-MERCH-SEQ                       00999100
                   DISPLAY 'WS-MERCH-REC-MERCH-ADDRESS='                 00999200
                            WS-MERCH-REC-MERCH-ADDRESS                   00999300
                   DISPLAY 'WS-MERCH-REC-MERCH-CITY='                    00999400
                            WS-MERCH-REC-MERCH-CITY                      00999500
                   DISPLAY 'WS-MERCH-REC-MERCH-STATE='                   00999600
                            WS-MERCH-REC-MERCH-STATE                     00999700
                   DISPLAY 'WS-MERCH-REC-MERCH-MSG='                     00999800
                            WS-MERCH-REC-MERCH-MSG                       00999900
                   PERFORM  1110-MOVE-WRITE-MERCH-REC                    01001200
 C5              ELSE DISPLAY 'READ-WS-MERCH-KSDS-STATUS-CODE='          01001300
                          WS-MERCH-KSDS-STATUS-CODE                      01001400
                 END-IF                                                  01001500
  >          END-PERFORM                                                 01001800
  -         .                                                            01008000
 C6     1110-MOVE-WRITE-MERCH-REC.                                       01008100
  V    **********************************************************        01008200
  |    ****PERFORMING MOVE AND WRIT STATED ABOVE****************         01008300
  |    **********************************************************        01008400
  |         DISPLAY  '1110-MOVE-WRITE-MERCH-REC'                         01008500
  |         DISPLAY  WS-MERCH-REC                                        01008600
  V    **********************************************************        01008700
  |    ****IF STATEMENTS FOR LINE COUNT**************************        01008800
  |    **********************************************************        01008900
            IF   WS-MERCH-PRT-LINE-COUNT > 11                            01009000
  |         THEN     PERFORM 1112-WRITE-PRT-MERCH-HDRS                   01010000
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020000
  |         ELSE                                                         01020100
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020200
  |         END-IF                                                       01020300
  _         .                                                            01020400
       ****************************************************************  01020500
1                                                                                                              PAGE 0024
 MEMBER NAME  BACKUPO2
       ****************************************************************  01020700
       ****************************************************************  01020800
 C7     1111-MOVE-FLDS-WRITE-MERCH-DTL.                                  01020900
  V         DISPLAY '1111-MOVE-FLDS-WRITE-MERCH-DTL'                     01021000
  |         MOVE  WS-MERCH-REC-MERCH-ID TO WS-MERCH-PRT-ID               01021100
  |         MOVE  WS-MERCH-REC-MERCH-SEQ TO WS-MERCH-PRT-SEQ             01021200
  |         MOVE  WS-MERCH-REC-MERCH-ADDRESS TO WS-MERCH-PRT-ADDRESS     01021400
            MOVE  WS-MERCH-REC-MERCH-CITY TO WS-MERCH-PRT-CITY           01021500
            MOVE  WS-MERCH-REC-MERCH-STATE TO WS-MERCH-PRT-STATE         01021600
            MOVE  WS-MERCH-REC-MERCH-MSG TO WS-MERCH-PRT-MSG             01021700
  |         ADD      1                  TO WS-MERCH-PRT-LINE-COUNT       01021800
  |         WRITE MERCH-PRT-REC       FROM WS-MERCH-PRT-REC AFTER 2 LINE 01021900
  |         .                                                            01022000
  |     1112-WRITE-PRT-MERCH-HDRS.                                       01022100
  |         DISPLAY '1112-WRITE-PRT-MERCH-HDRS'                          01022200
  |         ADD          1       TO WS-MERCH-PRT-PAGE-COUNT              01022300
  |         MOVE   WS-MERCH-PRT-PAGE-COUNT                               01022400
            TO WS-MERCH-PRT-HDR1-PAGE-COUNT                              01022500
  |         MOVE         0       TO WS-MERCH-PRT-LINE-COUNT              01022600
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR1 AFTER PAGE       01022700
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR2 AFTER 2 LINES    01022800
  _         .                                                            01022900
1                                                                                                              PAGE 0025
 MEMBER NAME  PGMV
        IDENTIFICATION DIVISION.                                         00010001
        PROGRAM-ID.       VSAMPGM.                                       00020068
       ***************************************************************** 00030002
       ***********    CHANGE LOG   ************************************* 00040002
       *---------------------------------------------------------------* 00050002
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060002
       *---------------------------------------------------------------* 00070002
       *    NONE          01-18      ORIGINAL CODE                       00080068
 C1    *    C1            01-18      MERCFILE INSERT AND FD              00090070
 C2    *    C2            01-18      MERCFILE WORKING STORAGE            00100070
 C3    *    C3            01-19      ADD MERCH PRINT FILE AND WS         00110088
 C4    *    C4            01-19      OPEN MERCH-KSDS                     00110188
 C5    *    C5            01-19      START AT TOP OF MERCH-KSDS AND READ 00110288
       *                             INTO MERCH REC                      00110388
 C6    *    C6            01-20      MOVE FIELDS AND HEADERS             00110496
 C7    *    C7            01-21      MOVE ALL MERCH REC IN TO PRT REC    00110596
       ***************************************************************** 00111041
       *******  PROGRAM STRUCTURE    *********************************** 00120002
       ***************************************************************** 00130002
       *** 0000-MAIN.                                                    00140002
       *** 1000-PROCESS-MERCH-KSDS                                       00191069
       ***     OPEN MERCH-KSDS                                           00192069
       ***         1100-PROCESS-MERCH-REC                                00193068
       ***     CLOSE MERCH-KSDS                                          00194069
       *** 1110-PROCESS-MERCH-REC-DETAILS                                00195068
       ***************************************************************** 00200002
        ENVIRONMENT DIVISION.                                            00210068
       *--------------------                                             00220068
        CONFIGURATION SECTION.                                           00230068
        INPUT-OUTPUT SECTION.                                            00231068
        FILE-CONTROL.                                                    00232068
       *----- ADD SELECT FOR MERCH-KSDS 5 LINES                          00235068
 C1         SELECT MERCH-KSDS ASSIGN TO MERCFILE                         00236070
 C1                ORGANIZATION      IS INDEXED                          00237068
 C1                ACCESS MODE       IS DYNAMIC                          00238068
 C1                RECORD KEY        IS MERCH-KEY                        00239068
 C1                FILE STATUS       IS WS-MERCH-KSDS-STATUS-CODE.       00239168
 C1         SELECT MERCH-PRT-FILE ASSIGN TO PRNTMERC.                    00239296
       **********************************************************        00240002
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250002
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260002
       **********************************************************        00270002
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290002
        DATA DIVISION.                                                   00300002
        FILE SECTION.                                                    00310016
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390002
 C1     FD  MERCH-KSDS                                                   00391068
 C1         RECORD CONTAINS 80 CHARACTERS.                               00392068
 C1     01  MERCH-REC.                                                   00393068
 C1         05  MERCH-KEY                      PIC X(13).                00394068
 C1         05                                 PIC X(67).                00395068
 C1     FD  MERCH-PRT-FILE                                               00396096
 C1         RECORD CONTAINS 133 CHARACTERS                               00397096
 C1         BLOCK  CONTAINS  0 RECORDS                                   00398096
 C1         RECORDING  MODE IS F.                                        00399096
 C1     01  MERCH-PRT-REC      PIC X(133).                               00399196
                                                                         00400002
        WORKING-STORAGE SECTION.                                         00410002
1                                                                                                              PAGE 0026
 MEMBER NAME  PGMV
       ********* WS - OUR DATA NAMES *******************                 00420002
 C2     01  WS-MERCH-REC.                                                00430068
 C2       05  WS-MERCH-REC-MERCH-ID          PIC X(13).                  00440079
 C2       05  WS-MERCH-REC-MERCH-SEQ         PIC X(02).                  00450079
 C2       05  WS-MERCH-REC-MERCH-ADDRESS     PIC X(24).                  00451068
 C2       05  WS-MERCH-REC-MERCH-CITY        PIC X(21).                  00452068
 C2       05  WS-MERCH-REC-MERCH-STATE       PIC X(02).                  00453068
 C2       05  WS-MERCH-REC-MERCH-MSG         PIC X(05).                  00454068
 C2       05                                 PIC X(13) VALUE SPACES.     00454168
                                                                         00455068
        01  WS-MERCH-PRT-LINE-COUNT  PIC 9(2)     VALUE 0.               00455168
        01  WS-MERCH-PRT-PAGE-COUNT  PIC 9(5)     VALUE 0.               00455268
        01  WS-MERCH-PRT-HDR1.                                           00455368
          05  FILLER               PIC X(20)     VALUE SPACES.           00455468
          05                       PIC X(17) VALUE '-MERCHANT RECORD-'.  00455568
          05                       PIC X(20)     VALUE SPACES.           00455668
          05                       PIC X(10)     VALUE 'PAGE NO:'.       00455768
          05  WS-MERCH-PRT-HDR1-PAGE-COUNT PIC ZZZZ9.                    00455868
          05                        PIC X(21)     VALUE SPACES.          00455968
        01  WS-MERCH-PRT-HDR2.                                           00456068
          05                         PIC X(05)       VALUE SPACES.       00456172
          05                         PIC X(13)  VALUE 'MERCH. ID'.       00456272
          05                         PIC X(05)       VALUE SPACES.       00456368
          05                         PIC X(10) VALUE 'MERCH. SEQ'.       00456472
          05                         PIC X(05)       VALUE SPACES.       00456568
          05                         PIC X(24)    VALUE 'ADDRESS'.       00456671
          05                         PIC X(05)       VALUE SPACES.       00456868
          05                         PIC X(21)       VALUE 'CITY'.       00456971
          05                         PIC X(05)       VALUE SPACES.       00457071
          05                         PIC X(05)       VALUE 'STATE'.      00457172
          05                         PIC X(05)       VALUE SPACES.       00457271
          05                         PIC X(05)       VALUE 'MSG'.        00457371
          05                         PIC X(28)       VALUE SPACES.       00457472
        01  WS-MERCH-PRT-REC.                                            00457571
          05                         PIC X(05)       VALUE SPACES.       00457671
          05  WS-MERCH-PRT-ID        PIC X(13).                          00457771
          05                         PIC X(05)       VALUE SPACES.       00457871
          05  WS-MERCH-PRT-SEQ       PIC X(10).                          00457972
          05                         PIC X(05)   VALUE SPACES.           00458071
          05  WS-MERCH-PRT-ADDRESS   PIC X(24).                          00458171
          05                         PIC X(05)   VALUE SPACES.           00458271
          05  WS-MERCH-PRT-CITY      PIC X(21).                          00458371
          05                         PIC X(05)   VALUE SPACES.           00458471
          05  WS-MERCH-PRT-STATE     PIC X(02).                          00458571
          05                         PIC X(05)   VALUE SPACES.           00458671
          05  WS-MERCH-PRT-MSG       PIC X(05).                          00458771
          05                         PIC X(28)   VALUE SPACES.           00458872
                                                                         00458971
        01 WS-MERCH-KSDS-STATUS-CODE          PIC X(02).                 00459071
        01 WS-INPUT-SWITCH                    PIC X(01) VALUE 'Y'.       00459171
               88 NO-MORE-INPUT       VALUE 'N'.                         00459271
               88 MORE-INPUT          VALUE 'Y'.                         00459371
        LINKAGE SECTION.                                                 00460042
        PROCEDURE DIVISION.                                              00470068
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480002
        0000-MAIN.                                                       00490002
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500002
            DISPLAY '0000-MAIN'                                          00510002
1                                                                                                              PAGE 0027
 MEMBER NAME  PGMV
                                                                         00520002
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530002
            PERFORM 1000-PROCESS-MERCH-KSDS                              00540069
       ********* GOBACK - RETURN TO Z/OS ****************                00560002
            GOBACK                                                       00570002
            .                                                            00580002
                                                                         00600002
 C4    **********************************************************        00972996
  V    *********************************************************         00973028
  |    **********************************************************        00973127
  |     1000-PROCESS-MERCH-KSDS.                                         00973269
  |    **********************************************************        00973327
  |    ***  OPEN THE MERCH FILE TO ALLOW FOR PROCESSING   **             00973468
  |    ***  PROCESS THE MERCH FILE IN THE 1000- PARAGRAPH **             00974068
  |    ***  CLOSE THE MERCH FILE WHEN THE PROCESSING IN        **        00975068
  |    ***      PARAGRAPH 1100- IS FINISHED                    **        00976068
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00977027
  |    **********************************************************        00978028
  |         DISPLAY '1000-PROCESS-MERCH-KSDS'                            00979069
  |                                                                      00979122
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00979222
 C6         MOVE 0 TO  WS-MERCH-PRT-PAGE-COUNT                           00979399
 C6         MOVE 30 TO WS-MERCH-PRT-LINE-COUNT                           00979499
  |         OPEN I-O   MERCH-KSDS                                        00979599
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00979696
  |            CONTINUE                                                  00979796
  |         ELSE DISPLAY 'OPEN-WS-MERCH-KSDS-STATUS-CODE='               00979896
  |                       WS-MERCH-KSDS-STATUS-CODE                      00979996
  |          END-IF                                                      00980096
  |         DISPLAY '**** S-T-A-R-T OF MERCH FILE****'                   00980568
  |         DISPLAY ' '                                                  00980642
  |    ********* USE OPEN OUTPUT TO READ A PRINT *********************** 00980769
  |         OPEN OUTPUT MERCH-PRT-FILE                                   00980869
  |                                                                      00981942
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00982042
  |         PERFORM 1100-PROCESS-MERCH-REC                               00982199
  |                  UNTIL WS-MERCH-KSDS-STATUS-CODE = '10'              00982299
  |                                                                      00982342
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00983022
  |         CLOSE MERCH-KSDS                                             00984069
  |         DISPLAY ' '                                                  00985042
  |         IF WS-MERCH-KSDS-STATUS-CODE = '00'                          00985196
               DISPLAY 'MERCH-KSDS CLOSE STATUS='                        00985299
                        WS-MERCH-KSDS-STATUS-CODE                        00985399
  |            CONTINUE                                                  00985496
  |         ELSE DISPLAY 'CLOSE-WS-MERCH-KSDS-STATUS-CODE='              00985596
  |                       WS-MERCH-KSDS-STATUS-CODE                      00985696
  |         DISPLAY '****  E-N-D OF MERCH FILE ****'                     00986068
  |         WRITE MERCH-PRT-REC                                          00986196
  |         CLOSE MERCH-PRT-FILE                                         00986396
  _         .                                                            00988042
       ***********************************************************       00991342
       ***********************************************************       00991442
       ***********************************************************       00991542
 C5                                                                      00991696
  V     1100-PROCESS-MERCH-REC.                                          00991796
  |    **********************************************************        00991842
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  *********        00991969
1                                                                                                              PAGE 0028
 MEMBER NAME  PGMV
  |    **********************************************************        00992042
  |         DISPLAY '1100-PROCESS-MERCH-REC'                             00992199
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *****        00992369
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS ******        00992469
  |    ********* MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM *        00992569
             MOVE   LOW-VALUES          TO MERCH-KEY                     00992773
             START MERCH-KSDS     KEY IS > MERCH-KEY                     00992879
             IF WS-MERCH-KSDS-STATUS-CODE = '00'                         00992979
                DISPLAY 'START STATUS=' WS-MERCH-KSDS-STATUS-CODE        00993099
                CONTINUE                                                 00993179
             ELSE DISPLAY 'START ERROR  -  WS-MERCH-KSDS-STATUS-CODE='   00993299
                           WS-MERCH-KSDS-STATUS-CODE                     00993379
             END-IF                                                      00993479
             MOVE '00'     TO WS-MERCH-KSDS-STATUS-CODE                  00993599
             PERFORM UNTIL WS-MERCH-KSDS-STATUS-CODE NOT EQUAL '00'      00993699
  |    **********************************************************        00993799
  |    ** = GOES AFTER NOT AND BEFORE SPACE *********************        00993842
  |    **********************************************************        00993942
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00994042
  |    **********************************************************        00994142
  |    ***END WITH "END-IF" STATEMENT****************************        00994242
  |    **********************************************************        00994342
                 READ MERCH-KSDS NEXT INTO WS-MERCH-REC                  00994499
                                                                         00994599
 C5              IF WS-MERCH-KSDS-STATUS-CODE = '00'                     00994699
                   DISPLAY 'READ-WS-MERCH-KSDS-STATUS-CODE='             00994799
                            WS-MERCH-KSDS-STATUS-CODE                    00994899
                   DISPLAY 'WS-MERCH-REC-MERCH-ID='                      00997099
                            WS-MERCH-REC-MERCH-ID                        00998099
                   DISPLAY 'WS-MERCH-REC-MERCH-SEQ='                     00999099
                            WS-MERCH-REC-MERCH-SEQ                       00999199
                   DISPLAY 'WS-MERCH-REC-MERCH-ADDRESS='                 00999299
                            WS-MERCH-REC-MERCH-ADDRESS                   00999399
                   DISPLAY 'WS-MERCH-REC-MERCH-CITY='                    00999499
                            WS-MERCH-REC-MERCH-CITY                      00999599
                   DISPLAY 'WS-MERCH-REC-MERCH-STATE='                   00999699
                            WS-MERCH-REC-MERCH-STATE                     00999799
                   DISPLAY 'WS-MERCH-REC-MERCH-MSG='                     00999899
                            WS-MERCH-REC-MERCH-MSG                       00999999
                   PERFORM  1110-MOVE-WRITE-MERCH-REC                    01001299
 C5              ELSE DISPLAY 'READ-WS-MERCH-KSDS-STATUS-CODE='          01001599
                          WS-MERCH-KSDS-STATUS-CODE                      01001699
                 END-IF                                                  01001799
  >          END-PERFORM                                                 01001899
  -         .                                                            01008028
 C6     1110-MOVE-WRITE-MERCH-REC.                                       01008197
  V    **********************************************************        01008228
  |    ****PERFORMING MOVE AND WRIT STATED ABOVE****************         01008342
  |    **********************************************************        01008428
  |         DISPLAY  '1110-MOVE-WRITE-MERCH-REC'                         01008568
  |         DISPLAY  WS-MERCH-REC                                        01008668
  V    **********************************************************        01008742
  |    ****IF STATEMENTS FOR LINE COUNT**************************        01008842
  |    **********************************************************        01008942
            IF   WS-MERCH-PRT-LINE-COUNT > 11                            01009068
  |         THEN     PERFORM 1112-WRITE-PRT-MERCH-HDRS                   01010069
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020069
  |         ELSE                                                         01020155
1                                                                                                              PAGE 0029
 MEMBER NAME  PGMV
  |                  PERFORM 1111-MOVE-FLDS-WRITE-MERCH-DTL              01020269
  |         END-IF                                                       01020355
  _         .                                                            01020441
       ****************************************************************  01020568
       ****************************************************************  01020797
       ****************************************************************  01020897
 C7     1111-MOVE-FLDS-WRITE-MERCH-DTL.                                  01020997
  V         DISPLAY '1111-MOVE-FLDS-WRITE-MERCH-DTL'                     01021097
  |         MOVE  WS-MERCH-REC-MERCH-ID TO WS-MERCH-PRT-ID               01021181
  |         MOVE  WS-MERCH-REC-MERCH-SEQ TO WS-MERCH-PRT-SEQ             01021271
  |         MOVE  WS-MERCH-REC-MERCH-ADDRESS TO WS-MERCH-PRT-ADDRESS     01021471
            MOVE  WS-MERCH-REC-MERCH-CITY TO WS-MERCH-PRT-CITY           01021581
            MOVE  WS-MERCH-REC-MERCH-STATE TO WS-MERCH-PRT-STATE         01021692
            MOVE  WS-MERCH-REC-MERCH-MSG TO WS-MERCH-PRT-MSG             01021792
  |         ADD      1                  TO WS-MERCH-PRT-LINE-COUNT       01021871
  |         WRITE MERCH-PRT-REC       FROM WS-MERCH-PRT-REC AFTER 2 LINE 01021971
  |         .                                                            01022055
  |     1112-WRITE-PRT-MERCH-HDRS.                                       01022169
  |         DISPLAY '1112-WRITE-PRT-MERCH-HDRS'                          01022269
  |         ADD          1       TO WS-MERCH-PRT-PAGE-COUNT              01022368
  |         MOVE   WS-MERCH-PRT-PAGE-COUNT                               01022482
            TO WS-MERCH-PRT-HDR1-PAGE-COUNT                              01022583
  |         MOVE         0       TO WS-MERCH-PRT-LINE-COUNT              01022668
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR1 AFTER PAGE       01022768
  |         WRITE  MERCH-PRT-REC FROM WS-MERCH-PRT-HDR2 AFTER 2 LINES    01022868
  _         .                                                            01022955
1                                                                                                              PAGE 0030
 MEMBER NAME  COMPILEV
 //TRAIN05V JOB ,,CLASS=A,NOTIFY=&SYSUID,TIME=(0,2)               <CHG   00010005
 //   JCLLIB ORDER=(TRAIN00.CLASS.COBOL)                                 00020000
 //STEP1        EXEC IGYWCLG,LIBPRFX=CEE,PARM.COBOL='LIST,MAP'           00030000
 //**************************************************************        00040000
 //**************************************************************        00050000
 //**************************************************************        00080000
 //**************************************************************        00090000
 //COBOL.SYSIN  DD  DSN=TRAIN05.CLASS.SIUA.CAPSTONE(PGMV),DISP=SHR <CHG  00100011
 //LKED.SYSLMOD DD  DSNAME=TRAIN05.CLASS.LOADLIB(COBSKEL),DISP=SHR <CHG  00110009
 //GO.STEPLIB   DD  DSNAME=TRAIN05.CLASS.LOADLIB,DISP=SHR          <CHG  00120009
 //**************************************************************        00130000
 //**************************************************************        00140000
 //GO.SYSOUT    DD  SYSOUT=*,OUTLIM=1000                                 00150009
 //GO.MERCFILE  DD  DSN=TRAIN05.CLASS.SIUA.CAPSTONE.KSDS.MERCH,DISP=SHR  00160011
 //PRNTMERC     DD SYSOUT=*,OUTLIM=1000                                  00170012
1                                                                                                              PAGE 0031
 MEMBER NAME  DCLMERCH
       ******************************************************************
       * DCLGEN TABLE(MERCHANT)                                         *
       *        LIBRARY(TRAIN05.CLASS.SIUA.CAPSTONE(DCLMERCH))          *
       *        ACTION(REPLACE)                                         *
       *        LANGUAGE(COBOL)                                         *
       *        NAMES(MERCH-)                                           *
       *        STRUCTURE(DCLMERCH)                                     *
       *        QUOTE                                                   *
       *        COLSUFFIX(YES)                                          *
       *        INDVAR(YES)                                             *
       * ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
       ******************************************************************
            EXEC SQL DECLARE MERCHANT TABLE
            ( ID                             DECIMAL(13, 0) NOT NULL,
              SEQ                            DECIMAL(2, 0) NOT NULL,
              ADDRESS                        CHAR(24) NOT NULL,
              CITY                           CHAR(21) NOT NULL,
              STATE                          CHAR(2) NOT NULL,
              MSG                            CHAR(5) NOT NULL
            ) END-EXEC.
       ******************************************************************
       * COBOL DECLARATION FOR TABLE MERCHANT                           *
       ******************************************************************
        01  DCLMERCH.
       *                       ID
            10 MERCH-ID             PIC S9(13)V USAGE COMP-3.
       *                       SEQ
            10 MERCH-SEQ            PIC S9(2)V USAGE COMP-3.
       *                       ADDRESS
            10 MERCH-ADDRESS        PIC X(24).
       *                       CITY
            10 MERCH-CITY           PIC X(21).
       *                       STATE
            10 MERCH-STATE          PIC X(2).
       *                       MSG
            10 MERCH-MSG            PIC X(5).
       ******************************************************************
       * INDICATOR VARIABLE STRUCTURE                                   *
       ******************************************************************
        01  IMERCHANT.
            10 INDSTRUC           PIC S9(4) USAGE COMP OCCURS 6 TIMES.
       ******************************************************************
       * THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 6       *
       ******************************************************************
